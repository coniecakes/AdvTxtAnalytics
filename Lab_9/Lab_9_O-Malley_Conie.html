<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Conie OMalley">
<meta name="dcterms.date" content="2025-03-30">

<title>Lab 9</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Lab_9_O-Malley_Conie_files/libs/clipboard/clipboard.min.js"></script>
<script src="Lab_9_O-Malley_Conie_files/libs/quarto-html/quarto.js"></script>
<script src="Lab_9_O-Malley_Conie_files/libs/quarto-html/popper.min.js"></script>
<script src="Lab_9_O-Malley_Conie_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Lab_9_O-Malley_Conie_files/libs/quarto-html/anchor.min.js"></script>
<link href="Lab_9_O-Malley_Conie_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Lab_9_O-Malley_Conie_files/libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Lab_9_O-Malley_Conie_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Lab_9_O-Malley_Conie_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Lab_9_O-Malley_Conie_files/libs/bootstrap/bootstrap-81e35ebdb4125010edbabe6010586085.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="Lab_9_O-Malley_Conie_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="Lab_9_O-Malley_Conie_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="Lab_9_O-Malley_Conie_files/libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="Lab_9_O-Malley_Conie_files/libs/typedarray-0.1/typedarray.min.js"></script>
<script src="Lab_9_O-Malley_Conie_files/libs/jquery-3.5.1/jquery.min.js"></script>
<link href="Lab_9_O-Malley_Conie_files/libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="Lab_9_O-Malley_Conie_files/libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="Lab_9_O-Malley_Conie_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="Lab_9_O-Malley_Conie_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul class="collapse">
  <li><a href="#pre-lab" id="toc-pre-lab" class="nav-link active" data-scroll-target="#pre-lab"><span class="header-section-number">1</span> Pre Lab</a>
  <ul class="collapse">
  <li><a href="#deliverable-1-get-your-working-directory-and-paste-below" id="toc-deliverable-1-get-your-working-directory-and-paste-below" class="nav-link" data-scroll-target="#deliverable-1-get-your-working-directory-and-paste-below"><span class="header-section-number">1.1</span> Deliverable 1: Get your working directory and paste below:</a></li>
  </ul></li>
  <li><a href="#part-1-introduction-to-k-means-clustering-with-synthetic-data" id="toc-part-1-introduction-to-k-means-clustering-with-synthetic-data" class="nav-link" data-scroll-target="#part-1-introduction-to-k-means-clustering-with-synthetic-data"><span class="header-section-number">2</span> Part 1: Introduction to K-Means Clustering with Synthetic Data</a>
  <ul class="collapse">
  <li><a href="#add-category-labels" id="toc-add-category-labels" class="nav-link" data-scroll-target="#add-category-labels"><span class="header-section-number">2.1</span> Add category labels</a></li>
  </ul></li>
  <li><a href="#create-corpus-and-preprocess-text" id="toc-create-corpus-and-preprocess-text" class="nav-link" data-scroll-target="#create-corpus-and-preprocess-text"><span class="header-section-number">3</span> Create corpus and preprocess text</a>
  <ul class="collapse">
  <li><a href="#create-dtm-and-explore-data" id="toc-create-dtm-and-explore-data" class="nav-link" data-scroll-target="#create-dtm-and-explore-data"><span class="header-section-number">3.1</span> Create DTM and explore data</a></li>
  <li><a href="#check-for-empty-documents" id="toc-check-for-empty-documents" class="nav-link" data-scroll-target="#check-for-empty-documents"><span class="header-section-number">3.2</span> Check for empty documents</a></li>
  <li><a href="#normalize-the-matrix" id="toc-normalize-the-matrix" class="nav-link" data-scroll-target="#normalize-the-matrix"><span class="header-section-number">3.3</span> Normalize the matrix</a></li>
  <li><a href="#perform-k-means-clustering-with-k3" id="toc-perform-k-means-clustering-with-k3" class="nav-link" data-scroll-target="#perform-k-means-clustering-with-k3"><span class="header-section-number">3.4</span> Perform k-means Clustering with k=3</a></li>
  <li><a href="#create-visualization-using-pca---principal-component-analysis" id="toc-create-visualization-using-pca---principal-component-analysis" class="nav-link" data-scroll-target="#create-visualization-using-pca---principal-component-analysis"><span class="header-section-number">3.5</span> Create visualization using PCA - Principal Component Analysis</a></li>
  <li><a href="#print-verification-of-cluster-assignments" id="toc-print-verification-of-cluster-assignments" class="nav-link" data-scroll-target="#print-verification-of-cluster-assignments"><span class="header-section-number">3.6</span> Print verification of cluster assignments</a></li>
  <li><a href="#print-top-terms-for-each-cluster" id="toc-print-top-terms-for-each-cluster" class="nav-link" data-scroll-target="#print-top-terms-for-each-cluster"><span class="header-section-number">3.7</span> Print top terms for each cluster</a></li>
  </ul></li>
  <li><a href="#part-2-complex-text-clustering-in-r-with-a-k-means-algorithm" id="toc-part-2-complex-text-clustering-in-r-with-a-k-means-algorithm" class="nav-link" data-scroll-target="#part-2-complex-text-clustering-in-r-with-a-k-means-algorithm"><span class="header-section-number">4</span> Part 2: Complex Text Clustering in R with a K-Means Algorithm</a>
  <ul class="collapse">
  <li><a href="#prepare-the-data" id="toc-prepare-the-data" class="nav-link" data-scroll-target="#prepare-the-data"><span class="header-section-number">4.1</span> Prepare the Data</a></li>
  <li><a href="#organize-by-chapter-words-and-create-document-term-matrix" id="toc-organize-by-chapter-words-and-create-document-term-matrix" class="nav-link" data-scroll-target="#organize-by-chapter-words-and-create-document-term-matrix"><span class="header-section-number">4.2</span> Organize by Chapter Words and Create Document-Term Matrix</a></li>
  <li><a href="#lets-try-to-reduce-the-size-of-the-dtm" id="toc-lets-try-to-reduce-the-size-of-the-dtm" class="nav-link" data-scroll-target="#lets-try-to-reduce-the-size-of-the-dtm"><span class="header-section-number">4.3</span> Let’s try to reduce the size of the dtm</a></li>
  <li><a href="#determine-optimal-number-of-clusters-with-elbow-method" id="toc-determine-optimal-number-of-clusters-with-elbow-method" class="nav-link" data-scroll-target="#determine-optimal-number-of-clusters-with-elbow-method"><span class="header-section-number">4.4</span> Determine Optimal Number of clusters with Elbow Method</a></li>
  <li><a href="#perform-k-means-clustering-with-k3-1" id="toc-perform-k-means-clustering-with-k3-1" class="nav-link" data-scroll-target="#perform-k-means-clustering-with-k3-1"><span class="header-section-number">4.5</span> Perform k-means clustering with k=3</a></li>
  <li><a href="#create-visualization-and-analysis-for-both" id="toc-create-visualization-and-analysis-for-both" class="nav-link" data-scroll-target="#create-visualization-and-analysis-for-both"><span class="header-section-number">4.6</span> Create visualization and analysis for both</a></li>
  <li><a href="#create-heatmaps-for-both-k3-and-k6" id="toc-create-heatmaps-for-both-k3-and-k6" class="nav-link" data-scroll-target="#create-heatmaps-for-both-k3-and-k6"><span class="header-section-number">4.7</span> Create heatmaps for both k=3 and k=6</a></li>
  <li><a href="#print-summary-statistics" id="toc-print-summary-statistics" class="nav-link" data-scroll-target="#print-summary-statistics"><span class="header-section-number">4.8</span> Print Summary Statistics</a></li>
  <li><a href="#display-heatmaps-for-both-k-values" id="toc-display-heatmaps-for-both-k-values" class="nav-link" data-scroll-target="#display-heatmaps-for-both-k-values"><span class="header-section-number">4.9</span> Display Heatmaps for both K Values</a></li>
  <li><a href="#calculate-and-display-characteristic-words-in-each-cluster-k3" id="toc-calculate-and-display-characteristic-words-in-each-cluster-k3" class="nav-link" data-scroll-target="#calculate-and-display-characteristic-words-in-each-cluster-k3"><span class="header-section-number">4.10</span> Calculate and Display Characteristic Words in Each Cluster (k=3)</a></li>
  <li><a href="#calculate-and-display-characteristic-words-in-each-cluster-k6" id="toc-calculate-and-display-characteristic-words-in-each-cluster-k6" class="nav-link" data-scroll-target="#calculate-and-display-characteristic-words-in-each-cluster-k6"><span class="header-section-number">4.11</span> Calculate and Display Characteristic Words in Each Cluster (k=6)</a></li>
  <li><a href="#print-the-k3-results-in-a-more-readable-format" id="toc-print-the-k3-results-in-a-more-readable-format" class="nav-link" data-scroll-target="#print-the-k3-results-in-a-more-readable-format"><span class="header-section-number">4.12</span> Print the k=3 results in a more readable format</a></li>
  </ul></li>
  <li><a href="#part-3-hierarchical-tree-clustering-in-r" id="toc-part-3-hierarchical-tree-clustering-in-r" class="nav-link" data-scroll-target="#part-3-hierarchical-tree-clustering-in-r"><span class="header-section-number">5</span> Part 3: Hierarchical (Tree) Clustering in R</a>
  <ul class="collapse">
  <li><a href="#load-the-customer-complaints-dataset-and-preprocess" id="toc-load-the-customer-complaints-dataset-and-preprocess" class="nav-link" data-scroll-target="#load-the-customer-complaints-dataset-and-preprocess"><span class="header-section-number">5.1</span> Load the Customer Complaint’s Dataset and Preprocess</a></li>
  <li><a href="#perform-hierarchical-clustering" id="toc-perform-hierarchical-clustering" class="nav-link" data-scroll-target="#perform-hierarchical-clustering"><span class="header-section-number">5.2</span> Perform Hierarchical Clustering</a></li>
  <li><a href="#calculate-distance-matrix-and-perform-hierarchical-clustering" id="toc-calculate-distance-matrix-and-perform-hierarchical-clustering" class="nav-link" data-scroll-target="#calculate-distance-matrix-and-perform-hierarchical-clustering"><span class="header-section-number">5.3</span> Calculate Distance Matrix and Perform Hierarchical Clustering</a></li>
  <li><a href="#visualize-the-dendrogram" id="toc-visualize-the-dendrogram" class="nav-link" data-scroll-target="#visualize-the-dendrogram"><span class="header-section-number">5.4</span> Visualize the Dendrogram</a></li>
  <li><a href="#cut-the-tree-into-clusters-and-analyze" id="toc-cut-the-tree-into-clusters-and-analyze" class="nav-link" data-scroll-target="#cut-the-tree-into-clusters-and-analyze"><span class="header-section-number">5.5</span> Cut the Tree into Clusters and Analyze</a></li>
  <li><a href="#get-top-words-for-each-cluster" id="toc-get-top-words-for-each-cluster" class="nav-link" data-scroll-target="#get-top-words-for-each-cluster"><span class="header-section-number">5.6</span> Get Top Words for Each Cluster</a></li>
  <li><a href="#create-cluster-visualization-using-factoextra" id="toc-create-cluster-visualization-using-factoextra" class="nav-link" data-scroll-target="#create-cluster-visualization-using-factoextra"><span class="header-section-number">5.7</span> Create Cluster Visualization Using Factoextra</a></li>
  <li><a href="#compare-different-distance-metrics" id="toc-compare-different-distance-metrics" class="nav-link" data-scroll-target="#compare-different-distance-metrics"><span class="header-section-number">5.8</span> Compare Different Distance Metrics</a></li>
  <li><a href="#convert-dendrogram-to-plotly-for-interactive-visualization" id="toc-convert-dendrogram-to-plotly-for-interactive-visualization" class="nav-link" data-scroll-target="#convert-dendrogram-to-plotly-for-interactive-visualization"><span class="header-section-number">5.9</span> Convert Dendrogram to Plotly for Interactive Visualization</a></li>
  </ul></li>
  <li><a href="#part-4-introduction-to-topic-modeling" id="toc-part-4-introduction-to-topic-modeling" class="nav-link" data-scroll-target="#part-4-introduction-to-topic-modeling"><span class="header-section-number">6</span> Part 4: Introduction to Topic Modeling</a>
  <ul class="collapse">
  <li><a href="#get-ap-data-and-build-a-dtm-to-submit-for-the-lda-model" id="toc-get-ap-data-and-build-a-dtm-to-submit-for-the-lda-model" class="nav-link" data-scroll-target="#get-ap-data-and-build-a-dtm-to-submit-for-the-lda-model"><span class="header-section-number">6.1</span> Get AP Data and Build a DTM to submit for the LDA model</a></li>
  <li><a href="#explore-and-interpret-the-model" id="toc-explore-and-interpret-the-model" class="nav-link" data-scroll-target="#explore-and-interpret-the-model"><span class="header-section-number">6.2</span> Explore and Interpret the Model</a></li>
  <li><a href="#visualize-the-top-terms" id="toc-visualize-the-top-terms" class="nav-link" data-scroll-target="#visualize-the-top-terms"><span class="header-section-number">6.3</span> Visualize the Top Terms</a></li>
  </ul></li>
  <li><a href="#part-5-topic-modelling-sanity-check-with-project-gutenberg" id="toc-part-5-topic-modelling-sanity-check-with-project-gutenberg" class="nav-link" data-scroll-target="#part-5-topic-modelling-sanity-check-with-project-gutenberg"><span class="header-section-number">7</span> Part 5: Topic Modelling Sanity Check with Project Gutenberg</a>
  <ul class="collapse">
  <li><a href="#collect-and-prepare-the-data" id="toc-collect-and-prepare-the-data" class="nav-link" data-scroll-target="#collect-and-prepare-the-data"><span class="header-section-number">7.1</span> Collect and Prepare the Data</a></li>
  <li><a href="#prepare-the-data-convert-the-tibble-to-a-dtm" id="toc-prepare-the-data-convert-the-tibble-to-a-dtm" class="nav-link" data-scroll-target="#prepare-the-data-convert-the-tibble-to-a-dtm"><span class="header-section-number">7.2</span> Prepare the Data: Convert the Tibble to a DTM</a></li>
  <li><a href="#create-the-lda-topic-model" id="toc-create-the-lda-topic-model" class="nav-link" data-scroll-target="#create-the-lda-topic-model"><span class="header-section-number">7.3</span> Create the LDA Topic Model</a></li>
  <li><a href="#create-a-per-document-classification" id="toc-create-a-per-document-classification" class="nav-link" data-scroll-target="#create-a-per-document-classification"><span class="header-section-number">7.4</span> Create a Per-Document Classification</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lab 9</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Conie OMalley </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 30, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="pre-lab" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Pre Lab</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>required_packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"tidyverse"</span>, <span class="st">"quanteda"</span>, <span class="st">"readtext"</span>, <span class="st">"stm"</span>, <span class="st">"stminsights"</span>, <span class="st">"wordcloud"</span>, <span class="st">"gsl"</span>, <span class="st">"topicmodels"</span>, </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"caret"</span>, <span class="st">"gutenbergr"</span>, <span class="st">"tidytext"</span>, <span class="st">"quanteda.textmodels"</span>, <span class="st">"tm"</span>, <span class="st">"igraph"</span>, <span class="st">"ggraph"</span>, <span class="st">"widyr"</span>, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"jsonlite"</span>, <span class="st">"factoextra"</span>, <span class="st">"janeaustenr"</span>, <span class="st">"cluster"</span>, <span class="st">"SnowballC"</span>, <span class="st">"proxy"</span>, <span class="st">"stringr"</span>, <span class="st">"textclean"</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"dendextend"</span>, <span class="st">"ggdendro"</span>, <span class="st">"plotly"</span>, <span class="st">"reticulate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="deliverable-1-get-your-working-directory-and-paste-below" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="deliverable-1-get-your-working-directory-and-paste-below"><span class="header-section-number">1.1</span> Deliverable 1: Get your working directory and paste below:</h2>
<p>“/Users/coniecakes/Library/CloudStorage/OneDrive-Personal/001. Documents - Main/023. Programming Tools/R Studio/AdvTxtAnalytics”</p>
</section>
</section>
<section id="part-1-introduction-to-k-means-clustering-with-synthetic-data" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Part 1: Introduction to K-Means Clustering with Synthetic Data</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>texts <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sports articles</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"The football team scored three touchdowns. The quarterback threw perfect passes."</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"The basketball team won with slam dunks and three-point shots."</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"The baseball pitcher threw a perfect game with many strikeouts."</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"The soccer team scored two goals and won the championship."</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Technology articles</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"The computer system processed data using advanced algorithms and databases."</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"The network router managed bandwidth through secure encryption protocols."</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"The software code executed functions through compiled programming syntax."</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"The digital platform integrated APIs with cloud computing architecture."</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Food articles</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"The professional chef created sauces and prepared gourmet dishes."</span>,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"The master baker produced artisan breads and pastries daily."</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"The culinary team seasoned meats and roasted vegetables."</span>,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"The kitchen staff garnished plates and plated entrees."</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="add-category-labels" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="add-category-labels"><span class="header-section-number">2.1</span> Add category labels</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>categories <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Sports"</span>, <span class="st">"Technology"</span>, <span class="st">"Food"</span>), <span class="at">each =</span> <span class="dv">4</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Initial document count:"</span>, {<span class="fu">length</span>(texts)})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Initial document count: 12</code></pre>
</div>
</div>
</section>
</section>
<section id="create-corpus-and-preprocess-text" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Create corpus and preprocess text</h1>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> tm<span class="sc">::</span><span class="fu">Corpus</span>(tm<span class="sc">::</span><span class="fu">VectorSource</span>(texts))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Corpus size:"</span>, {<span class="fu">length</span>(corpus)})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Corpus size: 12</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>cleanCorpus <span class="ot">&lt;-</span> <span class="cf">function</span>(corpus) {</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    corpus <span class="ot">&lt;-</span> tm<span class="sc">::</span><span class="fu">tm_map</span>(corpus, tm<span class="sc">::</span><span class="fu">content_transformer</span>(tolower))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    corpus <span class="ot">&lt;-</span> tm<span class="sc">::</span><span class="fu">tm_map</span>(corpus, tm<span class="sc">::</span>removePunctuation)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    corpus <span class="ot">&lt;-</span> tm<span class="sc">::</span><span class="fu">tm_map</span>(corpus, tm<span class="sc">::</span>removeNumbers)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    corpus <span class="ot">&lt;-</span> tm<span class="sc">::</span><span class="fu">tm_map</span>(corpus, tm<span class="sc">::</span>removeWords, tm<span class="sc">::</span><span class="fu">stopwords</span>(<span class="st">"english"</span>))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    corpus <span class="ot">&lt;-</span> tm<span class="sc">::</span><span class="fu">tm_map</span>(corpus, tm<span class="sc">::</span>stripWhitespace)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(corpus)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>cleaned_corpus <span class="ot">&lt;-</span> <span class="fu">cleanCorpus</span>(corpus)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in tm_map.SimpleCorpus(corpus, tm::content_transformer(tolower)):
transformation drops documents</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in tm_map.SimpleCorpus(corpus, tm::removePunctuation): transformation
drops documents</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in tm_map.SimpleCorpus(corpus, tm::removeNumbers): transformation drops
documents</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in tm_map.SimpleCorpus(corpus, tm::removeWords,
tm::stopwords("english")): transformation drops documents</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in tm_map.SimpleCorpus(corpus, tm::stripWhitespace): transformation
drops documents</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Cleaned corpus size:"</span>, {<span class="fu">length</span>(cleaned_corpus)})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Cleaned corpus size: 12</code></pre>
</div>
</div>
<section id="create-dtm-and-explore-data" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="create-dtm-and-explore-data"><span class="header-section-number">3.1</span> Create DTM and explore data</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>dtm <span class="ot">&lt;-</span> tm<span class="sc">::</span><span class="fu">DocumentTermMatrix</span>(cleaned_corpus)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"DTM dimensions:"</span>, {<span class="fu">dim</span>(dtm)})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>DTM dimensions: 12 78</code></pre>
</div>
</div>
</section>
<section id="check-for-empty-documents" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="check-for-empty-documents"><span class="header-section-number">3.2</span> Check for empty documents</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>dtm_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(dtm)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>row_sums <span class="ot">&lt;-</span> Matrix<span class="sc">::</span><span class="fu">rowSums</span>(dtm_matrix)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Document term counts:"</span>, {row_sums})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Document term counts: 9 7 7 7 8 7 7 7 7 7 6 6</code></pre>
</div>
</div>
</section>
<section id="normalize-the-matrix" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="normalize-the-matrix"><span class="header-section-number">3.3</span> Normalize the matrix</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>dtm_normalized <span class="ot">&lt;-</span> <span class="fu">scale</span>(dtm_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="perform-k-means-clustering-with-k3" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="perform-k-means-clustering-with-k3"><span class="header-section-number">3.4</span> Perform k-means Clustering with k=3</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>kmeans_result <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">kmeans</span>(dtm_normalized, <span class="at">centers =</span> <span class="dv">3</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="create-visualization-using-pca---principal-component-analysis" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="create-visualization-using-pca---principal-component-analysis"><span class="header-section-number">3.5</span> Create visualization using PCA - Principal Component Analysis</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>pca_result <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">prcomp</span>(dtm_normalized)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>cluster_plot_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">PC1 =</span> pca_result<span class="sc">$</span>x[,<span class="dv">1</span>],</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">PC2 =</span> pca_result<span class="sc">$</span>x[,<span class="dv">2</span>],</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Cluster =</span> <span class="fu">factor</span>(kmeans_result<span class="sc">$</span>cluster),</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Category =</span> categories</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co"># create scatter plot with enhanced visibility</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(cluster_plot_data, ggplot2<span class="sc">::</span><span class="fu">aes</span>(PC1, PC2, <span class="at">color =</span> Category, <span class="at">shape =</span> Cluster)) <span class="sc">+</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">5</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Document Clusters"</span>,</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">subtitle =</span> <span class="st">"Sports, Technology, and Food Articles"</span>,</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> <span class="st">"First Principal Component"</span>,</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> <span class="st">"Second Principal Component"</span>) <span class="sc">+</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    ggthemes<span class="sc">::</span><span class="fu">theme_economist_white</span>() <span class="sc">+</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">plot.title =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.text =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab_9_O-Malley_Conie_files/figure-html/PCA-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="print-verification-of-cluster-assignments" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="print-verification-of-cluster-assignments"><span class="header-section-number">3.6</span> Print verification of cluster assignments</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Cluster assignments by category:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Cluster assignments by category:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">table</span>(<span class="at">Category =</span> categories, <span class="at">Cluster =</span> kmeans_result<span class="sc">$</span>cluster))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Cluster
Category     1 2 3
  Food       1 3 0
  Sports     4 0 0
  Technology 0 3 1</code></pre>
</div>
</div>
</section>
<section id="print-top-terms-for-each-cluster" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="print-top-terms-for-each-cluster"><span class="header-section-number">3.7</span> Print top terms for each cluster</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Top terms per cluster:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Top terms per cluster:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>terms <span class="ot">&lt;-</span> <span class="fu">colnames</span>(dtm_matrix)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>centers <span class="ot">&lt;-</span> kmeans_result<span class="sc">$</span>centers</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">paste0</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Cluster "</span>, i, <span class="st">" top terms:</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    top_indices <span class="ot">&lt;-</span> <span class="fu">order</span>(centers[i,], <span class="at">decreasing =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(terms[top_indices])</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Cluster 1 top terms:
 [1] "team"       "perfect"    "scored"     "threw"      "won"       
 [6] "baseball"   "game"       "many"       "pitcher"    "strikeouts"

Cluster 2 top terms:
 [1] "artisan"   "baker"     "breads"    "daily"     "master"    "pastries" 
 [7] "produced"  "entrees"   "garnished" "kitchen"  

Cluster 3 top terms:
 [1] "advanced"     "algorithms"   "computer"     "data"         "databases"   
 [6] "processed"    "system"       "using"        "championship" "goals"       </code></pre>
</div>
</div>
</section>
</section>
<section id="part-2-complex-text-clustering-in-r-with-a-k-means-algorithm" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Part 2: Complex Text Clustering in R with a K-Means Algorithm</h1>
<section id="prepare-the-data" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="prepare-the-data"><span class="header-section-number">4.1</span> Prepare the Data</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>austen_books <span class="ot">&lt;-</span> janeaustenr<span class="sc">::</span><span class="fu">austen_books</span>() <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(book) <span class="sc">%&gt;%</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add line numbers within each book</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">linenumber =</span> <span class="fu">row_number</span>(),</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create chapter groups</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">chapter =</span> <span class="fu">cumsum</span>(stringr<span class="sc">::</span><span class="fu">str_detect</span>(text, stringr<span class="sc">::</span><span class="fu">regex</span>(<span class="st">"^chapter [</span><span class="sc">\\</span><span class="st">dIVXLC]"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">|</span> </span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>            stringr<span class="sc">::</span><span class="fu">str_detect</span>(text, stringr<span class="sc">::</span><span class="fu">regex</span>(<span class="st">"^[</span><span class="sc">\\</span><span class="st">dIVXLC]+"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="organize-by-chapter-words-and-create-document-term-matrix" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="organize-by-chapter-words-and-create-document-term-matrix"><span class="header-section-number">4.2</span> Organize by Chapter Words and Create Document-Term Matrix</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>stop_words <span class="ot">&lt;-</span> tm<span class="sc">::</span><span class="fu">stopwords</span>(<span class="st">"english"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>by_chapter_word <span class="ot">&lt;-</span> austen_books <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(chapter <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">unite</span>(document, book, chapter) <span class="sc">%&gt;%</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    tidytext<span class="sc">::</span><span class="fu">unnest_tokens</span>(word, text)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co"># remove stop words and count words</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>word_counts <span class="ot">&lt;-</span> by_chapter_word <span class="sc">%&gt;%</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">anti_join</span>(tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">word =</span> stop_words), <span class="at">by =</span> <span class="st">"word"</span>) <span class="sc">%&gt;%</span> <span class="co"># changed anti-join</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">count</span>(document, word, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">ungroup</span>()</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="co"># create a document-term matrix</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>chapters_dtm <span class="ot">&lt;-</span> word_counts <span class="sc">%&gt;%</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    tidytext<span class="sc">::</span><span class="fu">cast_dtm</span>(document, word, n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="lets-try-to-reduce-the-size-of-the-dtm" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="lets-try-to-reduce-the-size-of-the-dtm"><span class="header-section-number">4.3</span> Let’s try to reduce the size of the dtm</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(chapters_dtm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  8232 14372</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove sparse terms before converting to matrix</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>chapters_dtm_reduced <span class="ot">&lt;-</span> tm<span class="sc">::</span><span class="fu">removeSparseTerms</span>(chapters_dtm, <span class="at">sparse =</span> <span class="fl">0.99</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(chapters_dtm_reduced)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8232  740</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># now try the conversion with the reduced matrix</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>chapters_matrix <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(chapters_dtm_reduced)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>chapters_normalized <span class="ot">&lt;-</span> <span class="fu">scale</span>(chapters_matrix)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="determine-optimal-number-of-clusters-with-elbow-method" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="determine-optimal-number-of-clusters-with-elbow-method"><span class="header-section-number">4.4</span> Determine Optimal Number of clusters with Elbow Method</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>wss <span class="ot">&lt;-</span> <span class="cf">function</span>(k) {</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    stats<span class="sc">::</span><span class="fu">kmeans</span>(chapters_normalized, k, <span class="at">nstart =</span> <span class="dv">25</span>)<span class="sc">$</span>tot.withinss</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate WSS for k=1 to k=10</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>k.values <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>wss_values <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">map_dbl</span>(k.values, wss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: did not converge in 10 iterations
Warning: did not converge in 10 iterations
Warning: did not converge in 10 iterations
Warning: did not converge in 10 iterations
Warning: did not converge in 10 iterations
Warning: did not converge in 10 iterations
Warning: did not converge in 10 iterations
Warning: did not converge in 10 iterations
Warning: did not converge in 10 iterations
Warning: did not converge in 10 iterations
Warning: did not converge in 10 iterations
Warning: did not converge in 10 iterations</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot elbow curve</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>elbow_plot <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(<span class="at">k =</span> k.values, <span class="at">wss =</span> wss_values) <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(k, wss)) <span class="sc">+</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Elbow Method for Optimal k"</span>,</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> <span class="st">"Number of Clusters (k)"</span>,</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> <span class="st">"Total Within-cluster Sum of Squares"</span>) <span class="sc">+</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    ggthemes<span class="sc">::</span><span class="fu">theme_economist_white</span>()</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>elbow_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab_9_O-Malley_Conie_files/figure-html/cluster%20optimization-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="perform-k-means-clustering-with-k3-1" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="perform-k-means-clustering-with-k3-1"><span class="header-section-number">4.5</span> Perform k-means clustering with k=3</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># k=3 means clustering</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>) <span class="co"># for reproducibility</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>kmeans_3 <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">kmeans</span>(chapters_normalized, <span class="at">centers =</span> <span class="dv">3</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform k-means clustering with k=6</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>kmeans_6 <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">kmeans</span>(chapters_normalized, <span class="at">centers =</span> <span class="dv">6</span>, <span class="at">nstart =</span> <span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: did not converge in 10 iterations</code></pre>
</div>
</div>
</section>
<section id="create-visualization-and-analysis-for-both" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="create-visualization-and-analysis-for-both"><span class="header-section-number">4.6</span> Create visualization and analysis for both</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, let's look at which chapters are assigned to which clusters</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>cluster_assignments_3 <span class="ot">&lt;-</span> word_counts <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">separate</span>(document, <span class="fu">c</span>(<span class="st">"book"</span>, <span class="st">"chapter"</span>), <span class="at">sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>(book, chapter) <span class="sc">%&gt;%</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">cluster =</span> kmeans_3<span class="sc">$</span>cluster[<span class="fu">as.numeric</span>(<span class="fu">factor</span>(<span class="fu">paste0</span>(book, chapter, <span class="at">sep =</span> <span class="st">"_"</span>)))])</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>cluster_assignments_6 <span class="ot">&lt;-</span> word_counts <span class="sc">%&gt;%</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">separate</span>(document, <span class="fu">c</span>(<span class="st">"book"</span>, <span class="st">"chapter"</span>), <span class="at">sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">distinct</span>(book, chapter) <span class="sc">%&gt;%</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">cluster =</span> kmeans_6<span class="sc">$</span>cluster[<span class="fu">as.numeric</span>(<span class="fu">factor</span>(<span class="fu">paste</span>(book, chapter, <span class="at">sep =</span> <span class="st">"_"</span>)))])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="create-heatmaps-for-both-k3-and-k6" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="create-heatmaps-for-both-k3-and-k6"><span class="header-section-number">4.7</span> Create heatmaps for both k=3 and k=6</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>heatmap_3 <span class="ot">&lt;-</span> cluster_assignments_3 <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">count</span>(book, cluster) <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="fu">factor</span>(cluster), book, <span class="at">fill =</span> n)) <span class="sc">+</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cluster Distribution (k=3)"</span>,</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>                        <span class="at">x =</span> <span class="st">"Cluster"</span>,</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y =</span> <span class="st">"Book"</span>,</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fill =</span> <span class="st">"Number of Chapters"</span>) <span class="sc">+</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>        ggthemes<span class="sc">::</span><span class="fu">theme_economist_white</span>()</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>heatmap_6 <span class="ot">&lt;-</span> cluster_assignments_6 <span class="sc">%&gt;%</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">count</span>(book, cluster) <span class="sc">%&gt;%</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="fu">factor</span>(cluster), book, <span class="at">fill =</span> n)) <span class="sc">+</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cluster Distribution (k=6)"</span>,</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>                        <span class="at">x =</span> <span class="st">"Cluster"</span>,</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>                        <span class="at">y =</span> <span class="st">"Book"</span>,</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fill =</span> <span class="st">"Number of Chapters"</span>) <span class="sc">+</span></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>        ggthemes<span class="sc">::</span><span class="fu">theme_economist_white</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="print-summary-statistics" class="level2" data-number="4.8">
<h2 data-number="4.8" class="anchored" data-anchor-id="print-summary-statistics"><span class="header-section-number">4.8</span> Print Summary Statistics</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Cluster sizes for k=3:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Cluster sizes for k=3:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">table</span>(cluster_assignments_3<span class="sc">$</span>cluster))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
   1    2    3 
2298  482 5452 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Cluster composition for k=3:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Cluster composition for k=3:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">table</span>(cluster_assignments_3<span class="sc">$</span>book, cluster_assignments_3<span class="sc">$</span>cluster))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                     
                         1    2    3
  Emma                1028  450  260
  Mansfield Park       664   24  958
  Northanger Abbey     380    8  571
  Persuasion           184    0  861
  Pride &amp; Prejudice     24    0 1386
  Sense &amp; Sensibility   18    0 1416</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Cluster sizes for k=6:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Cluster sizes for k=6:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">table</span>(cluster_assignments_6<span class="sc">$</span>cluster))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
   1    2    3    4    5    6 
2181  197  246  250  213 5145 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Cluster composition for k=6:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Cluster composition for k=6:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">table</span>(cluster_assignments_6<span class="sc">$</span>book, cluster_assignments_6<span class="sc">$</span>cluster))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                     
                         1    2    3    4    5    6
  Emma                 811   95  230  223  184  195
  Mansfield Park       690   50   16    8   29  853
  Northanger Abbey     438   11    0   19    0  491
  Persuasion           161   40    0    0    0  844
  Pride &amp; Prejudice     46    0    0    0    0 1364
  Sense &amp; Sensibility   35    1    0    0    0 1398</code></pre>
</div>
</div>
</section>
<section id="display-heatmaps-for-both-k-values" class="level2" data-number="4.9">
<h2 data-number="4.9" class="anchored" data-anchor-id="display-heatmaps-for-both-k-values"><span class="header-section-number">4.9</span> Display Heatmaps for both K Values</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(heatmap_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab_9_O-Malley_Conie_files/figure-html/heatmaps-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(heatmap_6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab_9_O-Malley_Conie_files/figure-html/heatmaps-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="calculate-and-display-characteristic-words-in-each-cluster-k3" class="level2" data-number="4.10">
<h2 data-number="4.10" class="anchored" data-anchor-id="calculate-and-display-characteristic-words-in-each-cluster-k3"><span class="header-section-number">4.10</span> Calculate and Display Characteristic Words in Each Cluster (k=3)</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>cluster_words_3 <span class="ot">&lt;-</span> word_counts <span class="sc">%&gt;%</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">separate</span>(document, <span class="fu">c</span>(<span class="st">"book"</span>, <span class="st">"chapter"</span>), <span class="at">sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">cluster =</span> kmeans_3<span class="sc">$</span>cluster[<span class="fu">as.numeric</span>(<span class="fu">factor</span>(<span class="fu">paste0</span>(book, chapter, <span class="at">sep =</span> <span class="st">"_"</span>)))]) <span class="sc">%&gt;%</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(cluster, word) <span class="sc">%&gt;%</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(n), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(cluster) <span class="sc">%&gt;%</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">slice_max</span>(total, <span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="co"># Get top 10 words for each cluster</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(cluster, <span class="fu">desc</span>(total))</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Top words in each cluster (k=3):"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Top words in each cluster (k=3):"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cluster_words_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 30 × 3
# Groups:   cluster [3]
   cluster word  total
     &lt;int&gt; &lt;chr&gt; &lt;int&gt;
 1       1 mr      962
 2       1 miss    700
 3       1 mrs     687
 4       1 will    685
 5       1 must    639
 6       1 much    588
 7       1 one     555
 8       1 said    550
 9       1 well    471
10       1 emma    458
# ℹ 20 more rows</code></pre>
</div>
</div>
</section>
<section id="calculate-and-display-characteristic-words-in-each-cluster-k6" class="level2" data-number="4.11">
<h2 data-number="4.11" class="anchored" data-anchor-id="calculate-and-display-characteristic-words-in-each-cluster-k6"><span class="header-section-number">4.11</span> Calculate and Display Characteristic Words in Each Cluster (k=6)</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>cluster_words_6 <span class="ot">&lt;-</span> word_counts <span class="sc">%&gt;%</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">separate</span>(document, <span class="fu">c</span>(<span class="st">"book"</span>, <span class="st">"chapter"</span>), <span class="at">sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">cluster =</span> kmeans_6<span class="sc">$</span>cluster[<span class="fu">as.numeric</span>(<span class="fu">factor</span>(<span class="fu">paste</span>(book, chapter, <span class="at">sep =</span> <span class="st">"_"</span>)))]) <span class="sc">%&gt;%</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(cluster, word) <span class="sc">%&gt;%</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(n), <span class="at">.groups =</span> <span class="st">'drop'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(cluster) <span class="sc">%&gt;%</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">slice_max</span>(total, <span class="at">n =</span> <span class="dv">15</span>) <span class="sc">%&gt;%</span> <span class="co"># Get top 15 words for each cluster</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(cluster, <span class="fu">desc</span>(total))</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Top words in each cluster (k=6):"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Top words in each cluster (k=6):"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cluster_words_6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 92 × 3
# Groups:   cluster [6]
   cluster word  total
     &lt;int&gt; &lt;chr&gt; &lt;int&gt;
 1       1 mr      867
 2       1 mrs     643
 3       1 miss    627
 4       1 will    620
 5       1 must    608
 6       1 much    565
 7       1 one     522
 8       1 said    515
 9       1 well    453
10       1 might   426
# ℹ 82 more rows</code></pre>
</div>
</div>
</section>
<section id="print-the-k3-results-in-a-more-readable-format" class="level2" data-number="4.12">
<h2 data-number="4.12" class="anchored" data-anchor-id="print-the-k3-results-in-a-more-readable-format"><span class="header-section-number">4.12</span> Print the k=3 results in a more readable format</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>cluster_words_3 <span class="sc">%&gt;%</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(cluster) <span class="sc">%&gt;%</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">words =</span> <span class="fu">paste0</span>(word, <span class="at">collapse =</span> <span class="st">", "</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">cluster =</span> <span class="fu">paste0</span>(<span class="st">"Cluster"</span>, cluster)) <span class="sc">%&gt;%</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="at">width =</span> <span class="cn">Inf</span>) <span class="co"># Print full width</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  cluster  words                                                      
  &lt;chr&gt;    &lt;chr&gt;                                                      
1 Cluster1 mr, miss, mrs, will, must, much, one, said, well, emma     
2 Cluster2 mr, emma, mrs, must, will, said, miss, much, every, harriet
3 Cluster3 mr, mrs, will, said, must, much, one, miss, well, think    </code></pre>
</div>
</div>
</section>
</section>
<section id="part-3-hierarchical-tree-clustering-in-r" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Part 3: Hierarchical (Tree) Clustering in R</h1>
<section id="load-the-customer-complaints-dataset-and-preprocess" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="load-the-customer-complaints-dataset-and-preprocess"><span class="header-section-number">5.1</span> Load the Customer Complaint’s Dataset and Preprocess</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>complaints <span class="ot">&lt;-</span> utils<span class="sc">::</span><span class="fu">read.csv</span>(<span class="st">"/Users/coniecakes/Library/CloudStorage/OneDrive-Personal/001. Documents - Main/004_School/001. MBA_MS/008. Spring 2025/004. Advanced Text Analytics_ML/complaints.csv"</span>, <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Text preprocessing function</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>preprocess_text <span class="ot">&lt;-</span> <span class="cf">function</span>(text) {</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>    text <span class="sc">%&gt;%</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Convert to lowercase</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>        stringr<span class="sc">::</span><span class="fu">str_to_lower</span>() <span class="sc">%&gt;%</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Remove special characters and digits</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>        stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(<span class="st">"[^[:alpha:][:space:]]"</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Remove extra whitespace</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>        stringr<span class="sc">::</span><span class="fu">str_trim</span>() <span class="sc">%&gt;%</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>        stringr<span class="sc">::</span><span class="fu">str_squish</span>()</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply preprocessing</span></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>complaints <span class="ot">&lt;-</span> complaints <span class="sc">%&gt;%</span></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">processed_narrative =</span> purrr<span class="sc">::</span><span class="fu">map_chr</span>(consumer_complaint_narrative,</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>                                                        <span class="sc">~</span><span class="fu">preprocess_text</span>(<span class="fu">as.character</span>(.))))</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove missing values</span></span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>complaints <span class="ot">&lt;-</span> complaints <span class="sc">%&gt;%</span></span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(processed_narrative))</span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Create corpus</span></span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>corpus <span class="ot">&lt;-</span> tm<span class="sc">::</span><span class="fu">Corpus</span>(tm<span class="sc">::</span><span class="fu">VectorSource</span>(complaints<span class="sc">$</span>processed_narrative))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="perform-hierarchical-clustering" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="perform-hierarchical-clustering"><span class="header-section-number">5.2</span> Perform Hierarchical Clustering</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create document-term matrix</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>dtm_hierarchy <span class="ot">&lt;-</span> tm<span class="sc">::</span><span class="fu">DocumentTermMatrix</span>(corpus,</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">control =</span> <span class="fu">list</span>(</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">weighting =</span> tm<span class="sc">::</span>weightTfIdf,</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">stopwords =</span> <span class="cn">TRUE</span>,</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">removeNumbers =</span> <span class="cn">TRUE</span>,</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">removePunctuation =</span> <span class="cn">TRUE</span>,</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">stemming =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in TermDocumentMatrix.SimpleCorpus(x, control): custom functions are
ignored</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to matrix and remove sparse terms</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>dtm_matrix_hierarchy <span class="ot">&lt;-</span> tm<span class="sc">::</span><span class="fu">removeSparseTerms</span>(dtm_hierarchy, <span class="at">sparse =</span> <span class="fl">0.99</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>dtm_matrix_hierarchy <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(dtm_matrix_hierarchy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="calculate-distance-matrix-and-perform-hierarchical-clustering" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="calculate-distance-matrix-and-perform-hierarchical-clustering"><span class="header-section-number">5.3</span> Calculate Distance Matrix and Perform Hierarchical Clustering</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using first 100 documents for visualization purposes</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>dist_matrix <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">dist</span>(dtm_matrix_hierarchy[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,], <span class="at">method =</span> <span class="st">"euclidean"</span>)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform hierarchical clustering</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>hc <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">hclust</span>(dist_matrix, <span class="at">method =</span> <span class="st">"ward.D2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="visualize-the-dendrogram" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="visualize-the-dendrogram"><span class="header-section-number">5.4</span> Visualize the Dendrogram</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basic dendrogram</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>graphics<span class="sc">::</span><span class="fu">plot</span>(hc, <span class="at">main =</span> <span class="st">"Hierarchical Clustering Dendrogram"</span>,</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlab =</span> <span class="st">"Documents"</span>, <span class="at">ylab =</span> <span class="st">"Height"</span>,</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">cex =</span> <span class="fl">0.6</span>, <span class="at">hang =</span> <span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab_9_O-Malley_Conie_files/figure-html/dendrogram-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Enhanced dendrogram using dendextend</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>dend <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">as.dendrogram</span>(hc)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>dend <span class="ot">&lt;-</span> dendextend<span class="sc">::</span><span class="fu">color_branches</span>(dend, <span class="at">k =</span> <span class="dv">5</span>) <span class="co"># Color branches for 5 clusters</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot enhanced dendrogram</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>graphics<span class="sc">::</span><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>graphics<span class="sc">::</span><span class="fu">plot</span>(dend,</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">main =</span> <span class="st">"Colored Dendrogram with 5 Clusters"</span>,</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">ylab =</span> <span class="st">"Height"</span>,</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">leaflab =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab_9_O-Malley_Conie_files/figure-html/enhance%20dendrogram-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cut-the-tree-into-clusters-and-analyze" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="cut-the-tree-into-clusters-and-analyze"><span class="header-section-number">5.5</span> Cut the Tree into Clusters and Analyze</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cut tree into 5 clusters</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> dendextend<span class="sc">::</span><span class="fu">cutree</span>(hc, <span class="at">k =</span> <span class="dv">5</span>)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cluster assignments to the original data</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>complaints_subset <span class="ot">&lt;-</span> complaints[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,] <span class="sc">%&gt;%</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">cluster =</span> <span class="fu">as.factor</span>(clusters))</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Analyze clusters</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>cluster_summary <span class="ot">&lt;-</span> complaints_subset <span class="sc">%&gt;%</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(cluster) <span class="sc">%&gt;%</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">sample_complaints =</span> <span class="fu">list</span>(utils<span class="sc">::</span><span class="fu">head</span>(processed_narrative, <span class="dv">3</span>))</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Print cluster summaries</span></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(cluster_summary)) {</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Cluster"</span>, i, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Number of complaints:"</span>, cluster_summary<span class="sc">$</span>n[i], <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Sample complaints:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">unlist</span>(cluster_summary<span class="sc">$</span>sample_complaints[i]))</span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Cluster 1 
Number of complaints: 1 
Sample complaints:
[1] "transworld systems inc is trying to collect a debt that is not mine not owed and is inaccurate"


Cluster 2 
Number of complaints: 92 
Sample complaints:
[1] "i would like to request the suppression of the following items from my credit report which are the result of my falling victim to identity theft this information does not relate to transactions that i have madeaccounts that i have opened as the attached supporting documentation can attest as such it should be blocked from appearing on my credit report pursuant to section b of the fair credit reporting act"
[2] "over the past weeks i have been receiving excessive amounts of telephone calls from the company listed in this complaint the calls occur between xxxx xxxx and xxxx xxxx to my cell and at my job the company does not have the right to harass me at work and i want this to stop it is extremely distracting to be told times a day that i have a call from this collection agency while at work"                      
[3] "i was sold access to an event digitally of which i have all the screenshots to detail the transactions transferred the money and was provided with only a fake of a ticket i have reported this to paypal and it was for the amount of including a fee from paypal this occured on xxxx by paypal user who gave two accounts xxxx xxxx xxxx"                                                                             


Cluster 3 
Number of complaints: 3 
Sample complaints:
[1] "the credit bureaus are reporting inaccurateoutdatedincomplete personal information"
[2] "the credit bureaus are reporting inaccurateoutdatedincomplete personal information"
[3] "the credit bureaus are reporting inaccurateoutdatedincomplete personal information"


Cluster 4 
Number of complaints: 1 
Sample complaints:
[1] "the previous addresses reported on my behalf are incorrect"


Cluster 5 
Number of complaints: 3 
Sample complaints:
[1] "i am a victim of identity theft the information listed below which appears on my credit report does not relate to any transaction s that i have made it is the result of identity theft"
[2] "i am a victim of identity theft as previously stated"                                                                                                                                   
[3] "i am a victim of identity theft the information listed below which appears on my credit report does not relate to any transaction s that i have made it is the result of identity theft"</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>sil <span class="ot">&lt;-</span> cluster<span class="sc">::</span><span class="fu">silhouette</span>(clusters, dist_matrix)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>graphics<span class="sc">::</span><span class="fu">plot</span>(sil, <span class="at">main =</span> <span class="st">"Silhouette Plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab_9_O-Malley_Conie_files/figure-html/silhouette%20plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Average silhouette width</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>avg_sil <span class="ot">&lt;-</span> <span class="fu">mean</span>(sil[,<span class="dv">3</span>])</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Average silhouette width:"</span>, avg_sil)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Average silhouette width: 0.2230493</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot silhouette analysis using factoextra</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>factoextra<span class="sc">::</span><span class="fu">fviz_silhouette</span>(sil)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  cluster size ave.sil.width
1       1    1          0.00
2       2   92          0.20
3       3    3          1.00
4       4    1          0.00
5       5    3          0.35</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab_9_O-Malley_Conie_files/figure-html/color%20silhouette%20plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="get-top-words-for-each-cluster" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="get-top-words-for-each-cluster"><span class="header-section-number">5.6</span> Get Top Words for Each Cluster</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to get top words for each cluster</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>get_top_words <span class="ot">&lt;-</span> <span class="cf">function</span>(cluster_num, <span class="at">n_words =</span> <span class="dv">10</span>) {</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get documents in cluster</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>    cluster_docs <span class="ot">&lt;-</span> complaints_subset <span class="sc">%&gt;%</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">filter</span>(cluster <span class="sc">==</span> cluster_num) <span class="sc">%&gt;%</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">pull</span>(processed_narrative)</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create DTM for cluster</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>        cluster_corpus <span class="ot">&lt;-</span> tm<span class="sc">::</span><span class="fu">Corpus</span>(tm<span class="sc">::</span><span class="fu">VectorSource</span>(cluster_docs))</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>        cluster_dtm <span class="ot">&lt;-</span> tm<span class="sc">::</span><span class="fu">DocumentTermMatrix</span>(cluster_corpus,</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">control =</span> <span class="fu">list</span>(</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>                                                        <span class="at">weighting =</span> tm<span class="sc">::</span>weightTfIdf,</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>                                                        <span class="at">stopwords =</span> <span class="cn">TRUE</span>)</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>                                                        )</span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get term frequencies</span></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>    term_freq <span class="ot">&lt;-</span> <span class="fu">colSums</span>(<span class="fu">as.matrix</span>(cluster_dtm))</span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>    top_terms <span class="ot">&lt;-</span> <span class="fu">sort</span>(term_freq, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)[<span class="dv">1</span><span class="sc">:</span>n_words]</span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">names</span>(top_terms))</span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Print top words for each cluster</span></span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Cluster"</span>, i, <span class="st">"top words:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">get_top_words</span>(i))</span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Cluster 1 top words:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in TermDocumentMatrix.SimpleCorpus(x, control): custom functions are
ignored</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "collect"    "debt"       "inaccurate" "inc"        "mine"      
 [6] "owed"       "systems"    "transworld" "trying"     NA          

Cluster 2 top words:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in TermDocumentMatrix.SimpleCorpus(x, control): custom functions are
ignored</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "xxxx"      "xxxxxxxx"  "credit"    "late"      "report"    "reporting"
 [7] "card"      "accounts"  "account"   "balance"  

Cluster 3 top words:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in TermDocumentMatrix.SimpleCorpus(x, control): custom functions are
ignored</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "bureaus"                      "credit"                      
 [3] "inaccurateoutdatedincomplete" "information"                 
 [5] "personal"                     "reporting"                   
 [7] NA                             NA                            
 [9] NA                             NA                            

Cluster 4 top words:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in TermDocumentMatrix.SimpleCorpus(x, control): custom functions are
ignored</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "addresses" "behalf"    "incorrect" "previous"  "reported"  NA         
 [7] NA          NA          NA          NA         

Cluster 5 top words:</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in TermDocumentMatrix.SimpleCorpus(x, control): custom functions are
ignored</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "previously"  "stated"      "appears"     "credit"      "information"
 [6] "listed"      "made"        "relate"      "report"      "result"     </code></pre>
</div>
</div>
</section>
<section id="create-cluster-visualization-using-factoextra" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="create-cluster-visualization-using-factoextra"><span class="header-section-number">5.7</span> Create Cluster Visualization Using Factoextra</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform PCA on the distance matrix for visualization</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">prcomp</span>(dtm_matrix_hierarchy[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,])</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot clusters in first two principal components</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>factoextra<span class="sc">::</span><span class="fu">fviz_cluster</span>(<span class="fu">list</span>(<span class="at">data =</span> pca<span class="sc">$</span>x[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">cluster =</span> clusters),</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>                                <span class="at">main =</span> <span class="st">"Cluster Plot"</span>,</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>                                <span class="at">ellipse.type =</span> <span class="st">"convex"</span>,</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>                                <span class="at">repel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>                                <span class="at">show.clust.cent =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab_9_O-Malley_Conie_files/figure-html/cluster%20viz-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="compare-different-distance-metrics" class="level2" data-number="5.8">
<h2 data-number="5.8" class="anchored" data-anchor-id="compare-different-distance-metrics"><span class="header-section-number">5.8</span> Compare Different Distance Metrics</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare different distance metrics</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>distance_methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"euclidean"</span>, <span class="st">"manhattan"</span>, <span class="st">"cosine"</span>)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>dendlist <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(method <span class="cf">in</span> distance_methods) {</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>    dist_mat <span class="ot">&lt;-</span> proxy<span class="sc">::</span><span class="fu">dist</span>(dtm_matrix_hierarchy[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,], <span class="at">method =</span> method)</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>    hc_temp <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">hclust</span>(dist_mat, <span class="at">method =</span> <span class="st">"ward.D2"</span>)</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>    dendlist[[method]] <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">as.dendrogram</span>(hc_temp)</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare dendrograms</span></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>dend_list <span class="ot">&lt;-</span> dendextend<span class="sc">::</span><span class="fu">dendlist</span>(dendlist[[<span class="dv">1</span>]], dendlist[[<span class="dv">2</span>]], dendlist[[<span class="dv">3</span>]])</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(dend_list) <span class="ot">&lt;-</span> distance_methods</span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>dendextend<span class="sc">::</span><span class="fu">tanglegram</span>(dend_list[[<span class="dv">1</span>]], dend_list[[<span class="dv">2</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab_9_O-Malley_Conie_files/figure-html/metrics%20comparison-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="convert-dendrogram-to-plotly-for-interactive-visualization" class="level2" data-number="5.9">
<h2 data-number="5.9" class="anchored" data-anchor-id="convert-dendrogram-to-plotly-for-interactive-visualization"><span class="header-section-number">5.9</span> Convert Dendrogram to Plotly for Interactive Visualization</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert dendrogram to plotly</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>dend_data <span class="ot">&lt;-</span> ggdendro<span class="sc">::</span><span class="fu">dendro_data</span>(dend)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggdendro<span class="sc">::</span><span class="fu">segment</span>(dend_data)) <span class="sc">+</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>                        ggplot2<span class="sc">::</span><span class="fu">geom_segment</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">xend =</span> xend, <span class="at">yend =</span> yend)) <span class="sc">+</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>                        ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Dendrogram Visualization"</span>) <span class="sc">+</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>                        ggthemes<span class="sc">::</span><span class="fu">theme_economist_white</span>()</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>                        </span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>plotly<span class="sc">::</span><span class="fu">ggplotly</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-5d4e1770d66a86dcce96" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-5d4e1770d66a86dcce96">{"x":{"data":[{"x":[50.728257173263955,3.5815143465279107,null,3.5815143465279107,3.5815143465279107,null,50.728257173263955,97.875,null,97.875,97.875,null,3.5815143465279107,1.75,null,1.75,1.75,null,3.5815143465279107,5.4130286930558213,null,5.4130286930558213,5.4130286930558213,null,1.75,1,null,1,1,null,1.75,2.5,null,2.5,2.5,null,2.5,2,null,2,2,null,2.5,3,null,3,3,null,5.4130286930558213,4,null,4,4,null,5.4130286930558213,6.8260573861116427,null,6.8260573861116427,6.8260573861116427,null,6.8260573861116427,5,null,5,5,null,6.8260573861116427,8.6521147722232854,null,8.6521147722232854,8.6521147722232854,null,8.6521147722232854,6,null,6,6,null,8.6521147722232854,11.304229544446571,null,11.304229544446571,11.304229544446571,null,11.304229544446571,9.125,null,9.125,9.125,null,11.304229544446571,13.483459088893142,null,13.483459088893142,13.483459088893142,null,9.125,7.75,null,7.75,7.75,null,9.125,10.5,null,10.5,10.5,null,7.75,7,null,7,7,null,7.75,8.5,null,8.5,8.5,null,8.5,8,null,8,8,null,8.5,9,null,9,9,null,10.5,10,null,10,10,null,10.5,11,null,11,11,null,13.483459088893142,12,null,12,12,null,13.483459088893142,14.966918177786283,null,14.966918177786283,14.966918177786283,null,14.966918177786283,13,null,13,13,null,14.966918177786283,16.933836355572566,null,16.933836355572566,16.933836355572566,null,16.933836355572566,14.5,null,14.5,14.5,null,16.933836355572566,19.367672711145133,null,19.367672711145133,19.367672711145133,null,14.5,14,null,14,14,null,14.5,15,null,15,15,null,19.367672711145133,16.75,null,16.75,16.75,null,19.367672711145133,21.985345422290266,null,21.985345422290266,21.985345422290266,null,16.75,16,null,16,16,null,16.75,17.5,null,17.5,17.5,null,17.5,17,null,17,17,null,17.5,18,null,18,18,null,21.985345422290266,19.5,null,19.5,19.5,null,21.985345422290266,24.470690844580531,null,24.470690844580531,24.470690844580531,null,19.5,19,null,19,19,null,19.5,20,null,20,20,null,24.470690844580531,21,null,21,21,null,24.470690844580531,27.941381689161062,null,27.941381689161062,27.941381689161062,null,27.941381689161062,22.5,null,22.5,22.5,null,27.941381689161062,33.382763378322124,null,33.382763378322124,33.382763378322124,null,22.5,22,null,22,22,null,22.5,23,null,23,23,null,33.382763378322124,24,null,24,24,null,33.382763378322124,42.765526756644249,null,42.765526756644249,42.765526756644249,null,42.765526756644249,25.5,null,25.5,25.5,null,42.765526756644249,60.031053513288498,null,60.031053513288498,60.031053513288498,null,25.5,25,null,25,25,null,25.5,26,null,26,26,null,60.031053513288498,40.016696870326996,null,40.016696870326996,40.016696870326996,null,60.031053513288498,80.04541015625,null,80.04541015625,80.04541015625,null,40.016696870326996,27.75,null,27.75,27.75,null,40.016696870326996,52.283393740653992,null,52.283393740653992,52.283393740653992,null,27.75,27,null,27,27,null,27.75,28.5,null,28.5,28.5,null,28.5,28,null,28,28,null,28.5,29,null,29,29,null,52.283393740653992,32.816787481307983,null,32.816787481307983,32.816787481307983,null,52.283393740653992,71.75,null,71.75,71.75,null,32.816787481307983,30,null,30,30,null,32.816787481307983,35.633574962615967,null,35.633574962615967,35.633574962615967,null,35.633574962615967,31.96875,null,31.96875,31.96875,null,35.633574962615967,39.298399925231934,null,39.298399925231934,39.298399925231934,null,31.96875,31,null,31,31,null,31.96875,32.9375,null,32.9375,32.9375,null,32.9375,32,null,32,32,null,32.9375,33.875,null,33.875,33.875,null,33.875,33,null,33,33,null,33.875,34.75,null,34.75,34.75,null,34.75,34,null,34,34,null,34.75,35.5,null,35.5,35.5,null,35.5,35,null,35,35,null,35.5,36,null,36,36,null,39.298399925231934,37.5,null,37.5,37.5,null,39.298399925231934,41.096799850463867,null,41.096799850463867,41.096799850463867,null,37.5,37,null,37,37,null,37.5,38,null,38,38,null,41.096799850463867,39,null,39,39,null,41.096799850463867,43.193599700927734,null,43.193599700927734,43.193599700927734,null,43.193599700927734,40,null,40,40,null,43.193599700927734,46.387199401855469,null,46.387199401855469,46.387199401855469,null,46.387199401855469,42.625,null,42.625,42.625,null,46.387199401855469,50.149398803710938,null,50.149398803710938,50.149398803710938,null,42.625,41,null,41,41,null,42.625,44.25,null,44.25,44.25,null,44.25,42.75,null,42.75,42.75,null,44.25,45.75,null,45.75,45.75,null,42.75,42,null,42,42,null,42.75,43.5,null,43.5,43.5,null,43.5,43,null,43,43,null,43.5,44,null,44,44,null,45.75,45,null,45,45,null,45.75,46.5,null,46.5,46.5,null,46.5,46,null,46,46,null,46.5,47,null,47,47,null,50.149398803710938,48,null,48,48,null,50.149398803710938,52.298797607421875,null,52.298797607421875,52.298797607421875,null,52.298797607421875,49.5,null,49.5,49.5,null,52.298797607421875,55.09759521484375,null,55.09759521484375,55.09759521484375,null,49.5,49,null,49,49,null,49.5,50,null,50,50,null,55.09759521484375,51.75,null,51.75,51.75,null,55.09759521484375,58.4451904296875,null,58.4451904296875,58.4451904296875,null,51.75,51,null,51,51,null,51.75,52.5,null,52.5,52.5,null,52.5,52,null,52,52,null,52.5,53,null,53,53,null,58.4451904296875,54,null,54,54,null,58.4451904296875,62.890380859375,null,62.890380859375,62.890380859375,null,62.890380859375,56.28076171875,null,56.28076171875,56.28076171875,null,62.890380859375,69.5,null,69.5,69.5,null,56.28076171875,55,null,55,55,null,56.28076171875,57.5615234375,null,57.5615234375,57.5615234375,null,57.5615234375,56,null,56,56,null,57.5615234375,59.123046875,null,59.123046875,59.123046875,null,59.123046875,57.5,null,57.5,57.5,null,59.123046875,60.74609375,null,60.74609375,60.74609375,null,57.5,57,null,57,57,null,57.5,58,null,58,58,null,60.74609375,59.5,null,59.5,59.5,null,60.74609375,61.9921875,null,61.9921875,61.9921875,null,59.5,59,null,59,59,null,59.5,60,null,60,60,null,61.9921875,61,null,61,61,null,61.9921875,62.984375,null,62.984375,62.984375,null,62.984375,62,null,62,62,null,62.984375,63.96875,null,63.96875,63.96875,null,63.96875,63,null,63,63,null,63.96875,64.9375,null,64.9375,64.9375,null,64.9375,64,null,64,64,null,64.9375,65.875,null,65.875,65.875,null,65.875,65,null,65,65,null,65.875,66.75,null,66.75,66.75,null,66.75,66,null,66,66,null,66.75,67.5,null,67.5,67.5,null,67.5,67,null,67,67,null,67.5,68,null,68,68,null,69.5,69,null,69,69,null,69.5,70,null,70,70,null,71.75,71,null,71,71,null,71.75,72.5,null,72.5,72.5,null,72.5,72,null,72,72,null,72.5,73,null,73,73,null,80.04541015625,76.34375,null,76.34375,76.34375,null,80.04541015625,83.7470703125,null,83.7470703125,83.7470703125,null,76.34375,74.75,null,74.75,74.75,null,76.34375,77.9375,null,77.9375,77.9375,null,74.75,74,null,74,74,null,74.75,75.5,null,75.5,75.5,null,75.5,75,null,75,75,null,75.5,76,null,76,76,null,77.9375,77,null,77,77,null,77.9375,78.875,null,78.875,78.875,null,78.875,78,null,78,78,null,78.875,79.75,null,79.75,79.75,null,79.75,79,null,79,79,null,79.75,80.5,null,80.5,80.5,null,80.5,80,null,80,80,null,80.5,81,null,81,81,null,83.7470703125,82,null,82,82,null,83.7470703125,85.494140625,null,85.494140625,85.494140625,null,85.494140625,83,null,83,83,null,85.494140625,87.98828125,null,87.98828125,87.98828125,null,87.98828125,84.5,null,84.5,84.5,null,87.98828125,91.4765625,null,91.4765625,91.4765625,null,84.5,84,null,84,84,null,84.5,85,null,85,85,null,91.4765625,87.453125,null,87.453125,87.453125,null,91.4765625,95.5,null,95.5,95.5,null,87.453125,86,null,86,86,null,87.453125,88.90625,null,88.90625,88.90625,null,88.90625,87,null,87,87,null,88.90625,90.8125,null,90.8125,90.8125,null,90.8125,88.875,null,88.875,88.875,null,90.8125,92.75,null,92.75,92.75,null,88.875,88,null,88,88,null,88.875,89.75,null,89.75,89.75,null,89.75,89,null,89,89,null,89.75,90.5,null,90.5,90.5,null,90.5,90,null,90,90,null,90.5,91,null,91,91,null,92.75,92,null,92,92,null,92.75,93.5,null,93.5,93.5,null,93.5,93,null,93,93,null,93.5,94,null,94,94,null,95.5,95,null,95,95,null,95.5,96,null,96,96,null,97.875,97,null,97,97,null,97.875,98.75,null,98.75,98.75,null,98.75,98,null,98,98,null,98.75,99.5,null,99.5,99.5,null,99.5,99,null,99,99,null,99.5,100,null,100,100],"y":[2.5642854767969987,2.5642854767969987,null,2.5642854767969987,1.8263277181738669,null,2.5642854767969987,2.5642854767969987,null,2.5642854767969987,2.2926274326417611,null,1.8263277181738669,1.8263277181738669,null,1.8263277181738669,0,null,1.8263277181738669,1.8263277181738669,null,1.8263277181738669,1.6669786910485516,null,0,0,null,0,0,null,0,0,null,0,0,null,0,0,null,0,0,null,0,0,null,0,0,null,1.6669786910485516,1.6669786910485516,null,1.6669786910485516,0,null,1.6669786910485516,1.6669786910485516,null,1.6669786910485516,1.5378932298686099,null,1.5378932298686099,1.5378932298686099,null,1.5378932298686099,0,null,1.5378932298686099,1.5378932298686099,null,1.5378932298686099,1.3896651028404177,null,1.3896651028404177,1.3896651028404177,null,1.3896651028404177,0,null,1.3896651028404177,1.3896651028404177,null,1.3896651028404177,1.3221956163005548,null,1.3221956163005548,1.3221956163005548,null,1.3221956163005548,1.3055128196672152,null,1.3221956163005548,1.3221956163005548,null,1.3221956163005548,1.3143854897567395,null,1.3055128196672152,1.3055128196672152,null,1.3055128196672152,0.91602018278285402,null,1.3055128196672152,1.3055128196672152,null,1.3055128196672152,0.98923006133946112,null,0.91602018278285402,0.91602018278285402,null,0.91602018278285402,0,null,0.91602018278285402,0.91602018278285402,null,0.91602018278285402,0.79077496552014559,null,0.79077496552014559,0.79077496552014559,null,0.79077496552014559,0,null,0.79077496552014559,0.79077496552014559,null,0.79077496552014559,0,null,0.98923006133946112,0.98923006133946112,null,0.98923006133946112,0,null,0.98923006133946112,0.98923006133946112,null,0.98923006133946112,0,null,1.3143854897567395,1.3143854897567395,null,1.3143854897567395,0,null,1.3143854897567395,1.3143854897567395,null,1.3143854897567395,1.299976856097089,null,1.299976856097089,1.299976856097089,null,1.299976856097089,0,null,1.299976856097089,1.299976856097089,null,1.299976856097089,1.2226548515971691,null,1.2226548515971691,1.2226548515971691,null,1.2226548515971691,1.0914794487598307,null,1.2226548515971691,1.2226548515971691,null,1.2226548515971691,1.1962055146097121,null,1.0914794487598307,1.0914794487598307,null,1.0914794487598307,0,null,1.0914794487598307,1.0914794487598307,null,1.0914794487598307,0,null,1.1962055146097121,1.1962055146097121,null,1.1962055146097121,0.86195743467810892,null,1.1962055146097121,1.1962055146097121,null,1.1962055146097121,1.1837664431964121,null,0.86195743467810892,0.86195743467810892,null,0.86195743467810892,0,null,0.86195743467810892,0.86195743467810892,null,0.86195743467810892,0.64073611073669356,null,0.64073611073669356,0.64073611073669356,null,0.64073611073669356,0,null,0.64073611073669356,0.64073611073669356,null,0.64073611073669356,0,null,1.1837664431964121,1.1837664431964121,null,1.1837664431964121,0.23809567190652725,null,1.1837664431964121,1.1837664431964121,null,1.1837664431964121,1.1583627464343269,null,0.23809567190652725,0.23809567190652725,null,0.23809567190652725,0,null,0.23809567190652725,0.23809567190652725,null,0.23809567190652725,0,null,1.1583627464343269,1.1583627464343269,null,1.1583627464343269,0,null,1.1583627464343269,1.1583627464343269,null,1.1583627464343269,1.1170354345130344,null,1.1170354345130344,1.1170354345130344,null,1.1170354345130344,0,null,1.1170354345130344,1.1170354345130344,null,1.1170354345130344,1.0794683276388737,null,0,0,null,0,0,null,0,0,null,0,0,null,1.0794683276388737,1.0794683276388737,null,1.0794683276388737,0,null,1.0794683276388737,1.0794683276388737,null,1.0794683276388737,1.0298079353513996,null,1.0298079353513996,1.0298079353513996,null,1.0298079353513996,0.77143730637510499,null,1.0298079353513996,1.0298079353513996,null,1.0298079353513996,0.98489681733918921,null,0.77143730637510499,0.77143730637510499,null,0.77143730637510499,0,null,0.77143730637510499,0.77143730637510499,null,0.77143730637510499,0,null,0.98489681733918921,0.98489681733918921,null,0.98489681733918921,0.89966338929301504,null,0.98489681733918921,0.98489681733918921,null,0.98489681733918921,0.96622109484192165,null,0.89966338929301504,0.89966338929301504,null,0.89966338929301504,0.8579949786870702,null,0.89966338929301504,0.89966338929301504,null,0.89966338929301504,0.85974436778069763,null,0.8579949786870702,0.8579949786870702,null,0.8579949786870702,0,null,0.8579949786870702,0.8579949786870702,null,0.8579949786870702,0.69477772689256667,null,0.69477772689256667,0.69477772689256667,null,0.69477772689256667,0,null,0.69477772689256667,0.69477772689256667,null,0.69477772689256667,0,null,0.85974436778069763,0.85974436778069763,null,0.85974436778069763,0.81336830883099565,null,0.85974436778069763,0.85974436778069763,null,0.85974436778069763,0.82778996548814399,null,0.81336830883099565,0.81336830883099565,null,0.81336830883099565,0,null,0.81336830883099565,0.81336830883099565,null,0.81336830883099565,0.74577371790235181,null,0.74577371790235181,0.74577371790235181,null,0.74577371790235181,0.69372017089160343,null,0.74577371790235181,0.74577371790235181,null,0.74577371790235181,0.73731272641066803,null,0.69372017089160343,0.69372017089160343,null,0.69372017089160343,0,null,0.69372017089160343,0.69372017089160343,null,0.69372017089160343,0.67036693316457707,null,0.67036693316457707,0.67036693316457707,null,0.67036693316457707,0,null,0.67036693316457707,0.67036693316457707,null,0.67036693316457707,0.64652878965500171,null,0.64652878965500171,0.64652878965500171,null,0.64652878965500171,0,null,0.64652878965500171,0.64652878965500171,null,0.64652878965500171,0.62219764078031725,null,0.62219764078031725,0.62219764078031725,null,0.62219764078031725,0,null,0.62219764078031725,0.62219764078031725,null,0.62219764078031725,0.56596977561841011,null,0.56596977561841011,0.56596977561841011,null,0.56596977561841011,0,null,0.56596977561841011,0.56596977561841011,null,0.56596977561841011,0,null,0.73731272641066803,0.73731272641066803,null,0.73731272641066803,0.69416068824976773,null,0.73731272641066803,0.73731272641066803,null,0.73731272641066803,0.73419669983141389,null,0.69416068824976773,0.69416068824976773,null,0.69416068824976773,0,null,0.69416068824976773,0.69416068824976773,null,0.69416068824976773,0,null,0.73419669983141389,0.73419669983141389,null,0.73419669983141389,0,null,0.73419669983141389,0.73419669983141389,null,0.73419669983141389,0.71654361352102558,null,0.71654361352102558,0.71654361352102558,null,0.71654361352102558,0,null,0.71654361352102558,0.71654361352102558,null,0.71654361352102558,0.70049288424159883,null,0.70049288424159883,0.70049288424159883,null,0.70049288424159883,0.64452392988162088,null,0.70049288424159883,0.70049288424159883,null,0.70049288424159883,0.66942526010769299,null,0.64452392988162088,0.64452392988162088,null,0.64452392988162088,0,null,0.64452392988162088,0.64452392988162088,null,0.64452392988162088,0.5990661945532002,null,0.5990661945532002,0.5990661945532002,null,0.5990661945532002,0.53911278190012246,null,0.5990661945532002,0.5990661945532002,null,0.5990661945532002,0.57026049506085619,null,0.53911278190012246,0.53911278190012246,null,0.53911278190012246,0,null,0.53911278190012246,0.53911278190012246,null,0.53911278190012246,0,null,0,0,null,0,0,null,0,0,null,0,0,null,0.57026049506085619,0.57026049506085619,null,0.57026049506085619,0,null,0.57026049506085619,0.57026049506085619,null,0.57026049506085619,0.47643943439273878,null,0.47643943439273878,0.47643943439273878,null,0.47643943439273878,0,null,0.47643943439273878,0.47643943439273878,null,0.47643943439273878,0,null,0.66942526010769299,0.66942526010769299,null,0.66942526010769299,0,null,0.66942526010769299,0.66942526010769299,null,0.66942526010769299,0.66494693911481084,null,0.66494693911481084,0.66494693911481084,null,0.66494693911481084,0.61012561720966041,null,0.66494693911481084,0.66494693911481084,null,0.66494693911481084,0.64544292309342011,null,0.61012561720966041,0.61012561720966041,null,0.61012561720966041,0,null,0.61012561720966041,0.61012561720966041,null,0.61012561720966041,0,null,0.64544292309342011,0.64544292309342011,null,0.64544292309342011,0.50764546671803057,null,0.64544292309342011,0.64544292309342011,null,0.64544292309342011,0.62937223759509064,null,0.50764546671803057,0.50764546671803057,null,0.50764546671803057,0,null,0.50764546671803057,0.50764546671803057,null,0.50764546671803057,0.42955736918808901,null,0.42955736918808901,0.42955736918808901,null,0.42955736918808901,0,null,0.42955736918808901,0.42955736918808901,null,0.42955736918808901,0,null,0.62937223759509064,0.62937223759509064,null,0.62937223759509064,0,null,0.62937223759509064,0.62937223759509064,null,0.62937223759509064,0.61971877603736725,null,0.61971877603736725,0.61971877603736725,null,0.61971877603736725,0.53126993427528235,null,0.61971877603736725,0.61971877603736725,null,0.61971877603736725,0.59636468213624194,null,0.53126993427528235,0.53126993427528235,null,0.53126993427528235,0,null,0.53126993427528235,0.53126993427528235,null,0.53126993427528235,0.5284723675428008,null,0.5284723675428008,0.5284723675428008,null,0.5284723675428008,0,null,0.5284723675428008,0.5284723675428008,null,0.5284723675428008,0.5095061908514894,null,0.5095061908514894,0.5095061908514894,null,0.5095061908514894,0.46761095462094143,null,0.5095061908514894,0.5095061908514894,null,0.5095061908514894,0.49594878130934261,null,0.46761095462094143,0.46761095462094143,null,0.46761095462094143,0,null,0.46761095462094143,0.46761095462094143,null,0.46761095462094143,0,null,0.49594878130934261,0.49594878130934261,null,0.49594878130934261,0.45532301455577884,null,0.49594878130934261,0.49594878130934261,null,0.49594878130934261,0.46410184843558078,null,0.45532301455577884,0.45532301455577884,null,0.45532301455577884,0,null,0.45532301455577884,0.45532301455577884,null,0.45532301455577884,0,null,0.46410184843558078,0.46410184843558078,null,0.46410184843558078,0,null,0.46410184843558078,0.46410184843558078,null,0.46410184843558078,0.45122354340199822,null,0.45122354340199822,0.45122354340199822,null,0.45122354340199822,0,null,0.45122354340199822,0.45122354340199822,null,0.45122354340199822,0.42712130158294292,null,0.42712130158294292,0.42712130158294292,null,0.42712130158294292,0,null,0.42712130158294292,0.42712130158294292,null,0.42712130158294292,0.41555684635429002,null,0.41555684635429002,0.41555684635429002,null,0.41555684635429002,0,null,0.41555684635429002,0.41555684635429002,null,0.41555684635429002,0.37658033999415347,null,0.37658033999415347,0.37658033999415347,null,0.37658033999415347,0,null,0.37658033999415347,0.37658033999415347,null,0.37658033999415347,0.3592486321201725,null,0.3592486321201725,0.3592486321201725,null,0.3592486321201725,0,null,0.3592486321201725,0.3592486321201725,null,0.3592486321201725,0.34272979692002381,null,0.34272979692002381,0.34272979692002381,null,0.34272979692002381,0,null,0.34272979692002381,0.34272979692002381,null,0.34272979692002381,0,null,0.59636468213624194,0.59636468213624194,null,0.59636468213624194,0,null,0.59636468213624194,0.59636468213624194,null,0.59636468213624194,0,null,0.82778996548814399,0.82778996548814399,null,0.82778996548814399,0,null,0.82778996548814399,0.82778996548814399,null,0.82778996548814399,0.76377285771763304,null,0.76377285771763304,0.76377285771763304,null,0.76377285771763304,0,null,0.76377285771763304,0.76377285771763304,null,0.76377285771763304,0,null,0.96622109484192165,0.96622109484192165,null,0.96622109484192165,0.90422352907332493,null,0.96622109484192165,0.96622109484192165,null,0.96622109484192165,0.913612099078005,null,0.90422352907332493,0.90422352907332493,null,0.90422352907332493,0.71980255172733731,null,0.90422352907332493,0.90422352907332493,null,0.90422352907332493,0.76146701728808353,null,0.71980255172733731,0.71980255172733731,null,0.71980255172733731,0,null,0.71980255172733731,0.71980255172733731,null,0.71980255172733731,0.53439031206124255,null,0.53439031206124255,0.53439031206124255,null,0.53439031206124255,0,null,0.53439031206124255,0.53439031206124255,null,0.53439031206124255,0,null,0.76146701728808353,0.76146701728808353,null,0.76146701728808353,0,null,0.76146701728808353,0.76146701728808353,null,0.76146701728808353,0.65534944621911717,null,0.65534944621911717,0.65534944621911717,null,0.65534944621911717,0,null,0.65534944621911717,0.65534944621911717,null,0.65534944621911717,0.62288442078645612,null,0.62288442078645612,0.62288442078645612,null,0.62288442078645612,0,null,0.62288442078645612,0.62288442078645612,null,0.62288442078645612,0.60339328415256388,null,0.60339328415256388,0.60339328415256388,null,0.60339328415256388,0,null,0.60339328415256388,0.60339328415256388,null,0.60339328415256388,0,null,0.913612099078005,0.913612099078005,null,0.913612099078005,0,null,0.913612099078005,0.913612099078005,null,0.913612099078005,0.86167212651052638,null,0.86167212651052638,0.86167212651052638,null,0.86167212651052638,0,null,0.86167212651052638,0.86167212651052638,null,0.86167212651052638,0.80079973991677611,null,0.80079973991677611,0.80079973991677611,null,0.80079973991677611,0.71766222651559586,null,0.80079973991677611,0.80079973991677611,null,0.80079973991677611,0.75887258868575036,null,0.71766222651559586,0.71766222651559586,null,0.71766222651559586,0,null,0.71766222651559586,0.71766222651559586,null,0.71766222651559586,0,null,0.75887258868575036,0.75887258868575036,null,0.75887258868575036,0.64893674284715186,null,0.75887258868575036,0.75887258868575036,null,0.75887258868575036,0.65408383744896847,null,0.64893674284715186,0.64893674284715186,null,0.64893674284715186,0,null,0.64893674284715186,0.64893674284715186,null,0.64893674284715186,0.56226921525470419,null,0.56226921525470419,0.56226921525470419,null,0.56226921525470419,0,null,0.56226921525470419,0.56226921525470419,null,0.56226921525470419,0.52176153257381752,null,0.52176153257381752,0.52176153257381752,null,0.52176153257381752,0.39354815729097081,null,0.52176153257381752,0.52176153257381752,null,0.52176153257381752,0.44543221001382549,null,0.39354815729097081,0.39354815729097081,null,0.39354815729097081,0,null,0.39354815729097081,0.39354815729097081,null,0.39354815729097081,0.39003235326502361,null,0.39003235326502361,0.39003235326502361,null,0.39003235326502361,0,null,0.39003235326502361,0.39003235326502361,null,0.39003235326502361,0.31410617217330283,null,0.31410617217330283,0.31410617217330283,null,0.31410617217330283,0,null,0.31410617217330283,0.31410617217330283,null,0.31410617217330283,0,null,0.44543221001382549,0.44543221001382549,null,0.44543221001382549,0,null,0.44543221001382549,0.44543221001382549,null,0.44543221001382549,0.30699855981594193,null,0.30699855981594193,0.30699855981594193,null,0.30699855981594193,0,null,0.30699855981594193,0.30699855981594193,null,0.30699855981594193,0,null,0.65408383744896847,0.65408383744896847,null,0.65408383744896847,0,null,0.65408383744896847,0.65408383744896847,null,0.65408383744896847,0,null,2.2926274326417611,2.2926274326417611,null,2.2926274326417611,0,null,2.2926274326417611,2.2926274326417611,null,2.2926274326417611,1.4877886022396769,null,1.4877886022396769,1.4877886022396769,null,1.4877886022396769,0,null,1.4877886022396769,1.4877886022396769,null,1.4877886022396769,0,null,0,0,null,0,0,null,0,0,null,0,0],"text":["x:  50.728257<br />y: 2.5642855<br />xend:   3.581514<br />yend: 2.5642855","x:  50.728257<br />y: 2.5642855<br />xend:   3.581514<br />yend: 2.5642855",null,"x:   3.581514<br />y: 2.5642855<br />xend:   3.581514<br />yend: 1.8263277","x:   3.581514<br />y: 2.5642855<br />xend:   3.581514<br />yend: 1.8263277",null,"x:  50.728257<br />y: 2.5642855<br />xend:  97.875000<br />yend: 2.5642855","x:  50.728257<br />y: 2.5642855<br />xend:  97.875000<br />yend: 2.5642855",null,"x:  97.875000<br />y: 2.5642855<br />xend:  97.875000<br />yend: 2.2926274","x:  97.875000<br />y: 2.5642855<br />xend:  97.875000<br />yend: 2.2926274",null,"x:   3.581514<br />y: 1.8263277<br />xend:   1.750000<br />yend: 1.8263277","x:   3.581514<br />y: 1.8263277<br />xend:   1.750000<br />yend: 1.8263277",null,"x:   1.750000<br />y: 1.8263277<br />xend:   1.750000<br />yend: 0.0000000","x:   1.750000<br />y: 1.8263277<br />xend:   1.750000<br />yend: 0.0000000",null,"x:   3.581514<br />y: 1.8263277<br />xend:   5.413029<br />yend: 1.8263277","x:   3.581514<br />y: 1.8263277<br />xend:   5.413029<br />yend: 1.8263277",null,"x:   5.413029<br />y: 1.8263277<br />xend:   5.413029<br />yend: 1.6669787","x:   5.413029<br />y: 1.8263277<br />xend:   5.413029<br />yend: 1.6669787",null,"x:   1.750000<br />y: 0.0000000<br />xend:   1.000000<br />yend: 0.0000000","x:   1.750000<br />y: 0.0000000<br />xend:   1.000000<br />yend: 0.0000000",null,"x:   1.000000<br />y: 0.0000000<br />xend:   1.000000<br />yend: 0.0000000","x:   1.000000<br />y: 0.0000000<br />xend:   1.000000<br />yend: 0.0000000",null,"x:   1.750000<br />y: 0.0000000<br />xend:   2.500000<br />yend: 0.0000000","x:   1.750000<br />y: 0.0000000<br />xend:   2.500000<br />yend: 0.0000000",null,"x:   2.500000<br />y: 0.0000000<br />xend:   2.500000<br />yend: 0.0000000","x:   2.500000<br />y: 0.0000000<br />xend:   2.500000<br />yend: 0.0000000",null,"x:   2.500000<br />y: 0.0000000<br />xend:   2.000000<br />yend: 0.0000000","x:   2.500000<br />y: 0.0000000<br />xend:   2.000000<br />yend: 0.0000000",null,"x:   2.000000<br />y: 0.0000000<br />xend:   2.000000<br />yend: 0.0000000","x:   2.000000<br />y: 0.0000000<br />xend:   2.000000<br />yend: 0.0000000",null,"x:   2.500000<br />y: 0.0000000<br />xend:   3.000000<br />yend: 0.0000000","x:   2.500000<br />y: 0.0000000<br />xend:   3.000000<br />yend: 0.0000000",null,"x:   3.000000<br />y: 0.0000000<br />xend:   3.000000<br />yend: 0.0000000","x:   3.000000<br />y: 0.0000000<br />xend:   3.000000<br />yend: 0.0000000",null,"x:   5.413029<br />y: 1.6669787<br />xend:   4.000000<br />yend: 1.6669787","x:   5.413029<br />y: 1.6669787<br />xend:   4.000000<br />yend: 1.6669787",null,"x:   4.000000<br />y: 1.6669787<br />xend:   4.000000<br />yend: 0.0000000","x:   4.000000<br />y: 1.6669787<br />xend:   4.000000<br />yend: 0.0000000",null,"x:   5.413029<br />y: 1.6669787<br />xend:   6.826057<br />yend: 1.6669787","x:   5.413029<br />y: 1.6669787<br />xend:   6.826057<br />yend: 1.6669787",null,"x:   6.826057<br />y: 1.6669787<br />xend:   6.826057<br />yend: 1.5378932","x:   6.826057<br />y: 1.6669787<br />xend:   6.826057<br />yend: 1.5378932",null,"x:   6.826057<br />y: 1.5378932<br />xend:   5.000000<br />yend: 1.5378932","x:   6.826057<br />y: 1.5378932<br />xend:   5.000000<br />yend: 1.5378932",null,"x:   5.000000<br />y: 1.5378932<br />xend:   5.000000<br />yend: 0.0000000","x:   5.000000<br />y: 1.5378932<br />xend:   5.000000<br />yend: 0.0000000",null,"x:   6.826057<br />y: 1.5378932<br />xend:   8.652115<br />yend: 1.5378932","x:   6.826057<br />y: 1.5378932<br />xend:   8.652115<br />yend: 1.5378932",null,"x:   8.652115<br />y: 1.5378932<br />xend:   8.652115<br />yend: 1.3896651","x:   8.652115<br />y: 1.5378932<br />xend:   8.652115<br />yend: 1.3896651",null,"x:   8.652115<br />y: 1.3896651<br />xend:   6.000000<br />yend: 1.3896651","x:   8.652115<br />y: 1.3896651<br />xend:   6.000000<br />yend: 1.3896651",null,"x:   6.000000<br />y: 1.3896651<br />xend:   6.000000<br />yend: 0.0000000","x:   6.000000<br />y: 1.3896651<br />xend:   6.000000<br />yend: 0.0000000",null,"x:   8.652115<br />y: 1.3896651<br />xend:  11.304230<br />yend: 1.3896651","x:   8.652115<br />y: 1.3896651<br />xend:  11.304230<br />yend: 1.3896651",null,"x:  11.304230<br />y: 1.3896651<br />xend:  11.304230<br />yend: 1.3221956","x:  11.304230<br />y: 1.3896651<br />xend:  11.304230<br />yend: 1.3221956",null,"x:  11.304230<br />y: 1.3221956<br />xend:   9.125000<br />yend: 1.3221956","x:  11.304230<br />y: 1.3221956<br />xend:   9.125000<br />yend: 1.3221956",null,"x:   9.125000<br />y: 1.3221956<br />xend:   9.125000<br />yend: 1.3055128","x:   9.125000<br />y: 1.3221956<br />xend:   9.125000<br />yend: 1.3055128",null,"x:  11.304230<br />y: 1.3221956<br />xend:  13.483459<br />yend: 1.3221956","x:  11.304230<br />y: 1.3221956<br />xend:  13.483459<br />yend: 1.3221956",null,"x:  13.483459<br />y: 1.3221956<br />xend:  13.483459<br />yend: 1.3143855","x:  13.483459<br />y: 1.3221956<br />xend:  13.483459<br />yend: 1.3143855",null,"x:   9.125000<br />y: 1.3055128<br />xend:   7.750000<br />yend: 1.3055128","x:   9.125000<br />y: 1.3055128<br />xend:   7.750000<br />yend: 1.3055128",null,"x:   7.750000<br />y: 1.3055128<br />xend:   7.750000<br />yend: 0.9160202","x:   7.750000<br />y: 1.3055128<br />xend:   7.750000<br />yend: 0.9160202",null,"x:   9.125000<br />y: 1.3055128<br />xend:  10.500000<br />yend: 1.3055128","x:   9.125000<br />y: 1.3055128<br />xend:  10.500000<br />yend: 1.3055128",null,"x:  10.500000<br />y: 1.3055128<br />xend:  10.500000<br />yend: 0.9892301","x:  10.500000<br />y: 1.3055128<br />xend:  10.500000<br />yend: 0.9892301",null,"x:   7.750000<br />y: 0.9160202<br />xend:   7.000000<br />yend: 0.9160202","x:   7.750000<br />y: 0.9160202<br />xend:   7.000000<br />yend: 0.9160202",null,"x:   7.000000<br />y: 0.9160202<br />xend:   7.000000<br />yend: 0.0000000","x:   7.000000<br />y: 0.9160202<br />xend:   7.000000<br />yend: 0.0000000",null,"x:   7.750000<br />y: 0.9160202<br />xend:   8.500000<br />yend: 0.9160202","x:   7.750000<br />y: 0.9160202<br />xend:   8.500000<br />yend: 0.9160202",null,"x:   8.500000<br />y: 0.9160202<br />xend:   8.500000<br />yend: 0.7907750","x:   8.500000<br />y: 0.9160202<br />xend:   8.500000<br />yend: 0.7907750",null,"x:   8.500000<br />y: 0.7907750<br />xend:   8.000000<br />yend: 0.7907750","x:   8.500000<br />y: 0.7907750<br />xend:   8.000000<br />yend: 0.7907750",null,"x:   8.000000<br />y: 0.7907750<br />xend:   8.000000<br />yend: 0.0000000","x:   8.000000<br />y: 0.7907750<br />xend:   8.000000<br />yend: 0.0000000",null,"x:   8.500000<br />y: 0.7907750<br />xend:   9.000000<br />yend: 0.7907750","x:   8.500000<br />y: 0.7907750<br />xend:   9.000000<br />yend: 0.7907750",null,"x:   9.000000<br />y: 0.7907750<br />xend:   9.000000<br />yend: 0.0000000","x:   9.000000<br />y: 0.7907750<br />xend:   9.000000<br />yend: 0.0000000",null,"x:  10.500000<br />y: 0.9892301<br />xend:  10.000000<br />yend: 0.9892301","x:  10.500000<br />y: 0.9892301<br />xend:  10.000000<br />yend: 0.9892301",null,"x:  10.000000<br />y: 0.9892301<br />xend:  10.000000<br />yend: 0.0000000","x:  10.000000<br />y: 0.9892301<br />xend:  10.000000<br />yend: 0.0000000",null,"x:  10.500000<br />y: 0.9892301<br />xend:  11.000000<br />yend: 0.9892301","x:  10.500000<br />y: 0.9892301<br />xend:  11.000000<br />yend: 0.9892301",null,"x:  11.000000<br />y: 0.9892301<br />xend:  11.000000<br />yend: 0.0000000","x:  11.000000<br />y: 0.9892301<br />xend:  11.000000<br />yend: 0.0000000",null,"x:  13.483459<br />y: 1.3143855<br />xend:  12.000000<br />yend: 1.3143855","x:  13.483459<br />y: 1.3143855<br />xend:  12.000000<br />yend: 1.3143855",null,"x:  12.000000<br />y: 1.3143855<br />xend:  12.000000<br />yend: 0.0000000","x:  12.000000<br />y: 1.3143855<br />xend:  12.000000<br />yend: 0.0000000",null,"x:  13.483459<br />y: 1.3143855<br />xend:  14.966918<br />yend: 1.3143855","x:  13.483459<br />y: 1.3143855<br />xend:  14.966918<br />yend: 1.3143855",null,"x:  14.966918<br />y: 1.3143855<br />xend:  14.966918<br />yend: 1.2999769","x:  14.966918<br />y: 1.3143855<br />xend:  14.966918<br />yend: 1.2999769",null,"x:  14.966918<br />y: 1.2999769<br />xend:  13.000000<br />yend: 1.2999769","x:  14.966918<br />y: 1.2999769<br />xend:  13.000000<br />yend: 1.2999769",null,"x:  13.000000<br />y: 1.2999769<br />xend:  13.000000<br />yend: 0.0000000","x:  13.000000<br />y: 1.2999769<br />xend:  13.000000<br />yend: 0.0000000",null,"x:  14.966918<br />y: 1.2999769<br />xend:  16.933836<br />yend: 1.2999769","x:  14.966918<br />y: 1.2999769<br />xend:  16.933836<br />yend: 1.2999769",null,"x:  16.933836<br />y: 1.2999769<br />xend:  16.933836<br />yend: 1.2226549","x:  16.933836<br />y: 1.2999769<br />xend:  16.933836<br />yend: 1.2226549",null,"x:  16.933836<br />y: 1.2226549<br />xend:  14.500000<br />yend: 1.2226549","x:  16.933836<br />y: 1.2226549<br />xend:  14.500000<br />yend: 1.2226549",null,"x:  14.500000<br />y: 1.2226549<br />xend:  14.500000<br />yend: 1.0914794","x:  14.500000<br />y: 1.2226549<br />xend:  14.500000<br />yend: 1.0914794",null,"x:  16.933836<br />y: 1.2226549<br />xend:  19.367673<br />yend: 1.2226549","x:  16.933836<br />y: 1.2226549<br />xend:  19.367673<br />yend: 1.2226549",null,"x:  19.367673<br />y: 1.2226549<br />xend:  19.367673<br />yend: 1.1962055","x:  19.367673<br />y: 1.2226549<br />xend:  19.367673<br />yend: 1.1962055",null,"x:  14.500000<br />y: 1.0914794<br />xend:  14.000000<br />yend: 1.0914794","x:  14.500000<br />y: 1.0914794<br />xend:  14.000000<br />yend: 1.0914794",null,"x:  14.000000<br />y: 1.0914794<br />xend:  14.000000<br />yend: 0.0000000","x:  14.000000<br />y: 1.0914794<br />xend:  14.000000<br />yend: 0.0000000",null,"x:  14.500000<br />y: 1.0914794<br />xend:  15.000000<br />yend: 1.0914794","x:  14.500000<br />y: 1.0914794<br />xend:  15.000000<br />yend: 1.0914794",null,"x:  15.000000<br />y: 1.0914794<br />xend:  15.000000<br />yend: 0.0000000","x:  15.000000<br />y: 1.0914794<br />xend:  15.000000<br />yend: 0.0000000",null,"x:  19.367673<br />y: 1.1962055<br />xend:  16.750000<br />yend: 1.1962055","x:  19.367673<br />y: 1.1962055<br />xend:  16.750000<br />yend: 1.1962055",null,"x:  16.750000<br />y: 1.1962055<br />xend:  16.750000<br />yend: 0.8619574","x:  16.750000<br />y: 1.1962055<br />xend:  16.750000<br />yend: 0.8619574",null,"x:  19.367673<br />y: 1.1962055<br />xend:  21.985345<br />yend: 1.1962055","x:  19.367673<br />y: 1.1962055<br />xend:  21.985345<br />yend: 1.1962055",null,"x:  21.985345<br />y: 1.1962055<br />xend:  21.985345<br />yend: 1.1837664","x:  21.985345<br />y: 1.1962055<br />xend:  21.985345<br />yend: 1.1837664",null,"x:  16.750000<br />y: 0.8619574<br />xend:  16.000000<br />yend: 0.8619574","x:  16.750000<br />y: 0.8619574<br />xend:  16.000000<br />yend: 0.8619574",null,"x:  16.000000<br />y: 0.8619574<br />xend:  16.000000<br />yend: 0.0000000","x:  16.000000<br />y: 0.8619574<br />xend:  16.000000<br />yend: 0.0000000",null,"x:  16.750000<br />y: 0.8619574<br />xend:  17.500000<br />yend: 0.8619574","x:  16.750000<br />y: 0.8619574<br />xend:  17.500000<br />yend: 0.8619574",null,"x:  17.500000<br />y: 0.8619574<br />xend:  17.500000<br />yend: 0.6407361","x:  17.500000<br />y: 0.8619574<br />xend:  17.500000<br />yend: 0.6407361",null,"x:  17.500000<br />y: 0.6407361<br />xend:  17.000000<br />yend: 0.6407361","x:  17.500000<br />y: 0.6407361<br />xend:  17.000000<br />yend: 0.6407361",null,"x:  17.000000<br />y: 0.6407361<br />xend:  17.000000<br />yend: 0.0000000","x:  17.000000<br />y: 0.6407361<br />xend:  17.000000<br />yend: 0.0000000",null,"x:  17.500000<br />y: 0.6407361<br />xend:  18.000000<br />yend: 0.6407361","x:  17.500000<br />y: 0.6407361<br />xend:  18.000000<br />yend: 0.6407361",null,"x:  18.000000<br />y: 0.6407361<br />xend:  18.000000<br />yend: 0.0000000","x:  18.000000<br />y: 0.6407361<br />xend:  18.000000<br />yend: 0.0000000",null,"x:  21.985345<br />y: 1.1837664<br />xend:  19.500000<br />yend: 1.1837664","x:  21.985345<br />y: 1.1837664<br />xend:  19.500000<br />yend: 1.1837664",null,"x:  19.500000<br />y: 1.1837664<br />xend:  19.500000<br />yend: 0.2380957","x:  19.500000<br />y: 1.1837664<br />xend:  19.500000<br />yend: 0.2380957",null,"x:  21.985345<br />y: 1.1837664<br />xend:  24.470691<br />yend: 1.1837664","x:  21.985345<br />y: 1.1837664<br />xend:  24.470691<br />yend: 1.1837664",null,"x:  24.470691<br />y: 1.1837664<br />xend:  24.470691<br />yend: 1.1583627","x:  24.470691<br />y: 1.1837664<br />xend:  24.470691<br />yend: 1.1583627",null,"x:  19.500000<br />y: 0.2380957<br />xend:  19.000000<br />yend: 0.2380957","x:  19.500000<br />y: 0.2380957<br />xend:  19.000000<br />yend: 0.2380957",null,"x:  19.000000<br />y: 0.2380957<br />xend:  19.000000<br />yend: 0.0000000","x:  19.000000<br />y: 0.2380957<br />xend:  19.000000<br />yend: 0.0000000",null,"x:  19.500000<br />y: 0.2380957<br />xend:  20.000000<br />yend: 0.2380957","x:  19.500000<br />y: 0.2380957<br />xend:  20.000000<br />yend: 0.2380957",null,"x:  20.000000<br />y: 0.2380957<br />xend:  20.000000<br />yend: 0.0000000","x:  20.000000<br />y: 0.2380957<br />xend:  20.000000<br />yend: 0.0000000",null,"x:  24.470691<br />y: 1.1583627<br />xend:  21.000000<br />yend: 1.1583627","x:  24.470691<br />y: 1.1583627<br />xend:  21.000000<br />yend: 1.1583627",null,"x:  21.000000<br />y: 1.1583627<br />xend:  21.000000<br />yend: 0.0000000","x:  21.000000<br />y: 1.1583627<br />xend:  21.000000<br />yend: 0.0000000",null,"x:  24.470691<br />y: 1.1583627<br />xend:  27.941382<br />yend: 1.1583627","x:  24.470691<br />y: 1.1583627<br />xend:  27.941382<br />yend: 1.1583627",null,"x:  27.941382<br />y: 1.1583627<br />xend:  27.941382<br />yend: 1.1170354","x:  27.941382<br />y: 1.1583627<br />xend:  27.941382<br />yend: 1.1170354",null,"x:  27.941382<br />y: 1.1170354<br />xend:  22.500000<br />yend: 1.1170354","x:  27.941382<br />y: 1.1170354<br />xend:  22.500000<br />yend: 1.1170354",null,"x:  22.500000<br />y: 1.1170354<br />xend:  22.500000<br />yend: 0.0000000","x:  22.500000<br />y: 1.1170354<br />xend:  22.500000<br />yend: 0.0000000",null,"x:  27.941382<br />y: 1.1170354<br />xend:  33.382763<br />yend: 1.1170354","x:  27.941382<br />y: 1.1170354<br />xend:  33.382763<br />yend: 1.1170354",null,"x:  33.382763<br />y: 1.1170354<br />xend:  33.382763<br />yend: 1.0794683","x:  33.382763<br />y: 1.1170354<br />xend:  33.382763<br />yend: 1.0794683",null,"x:  22.500000<br />y: 0.0000000<br />xend:  22.000000<br />yend: 0.0000000","x:  22.500000<br />y: 0.0000000<br />xend:  22.000000<br />yend: 0.0000000",null,"x:  22.000000<br />y: 0.0000000<br />xend:  22.000000<br />yend: 0.0000000","x:  22.000000<br />y: 0.0000000<br />xend:  22.000000<br />yend: 0.0000000",null,"x:  22.500000<br />y: 0.0000000<br />xend:  23.000000<br />yend: 0.0000000","x:  22.500000<br />y: 0.0000000<br />xend:  23.000000<br />yend: 0.0000000",null,"x:  23.000000<br />y: 0.0000000<br />xend:  23.000000<br />yend: 0.0000000","x:  23.000000<br />y: 0.0000000<br />xend:  23.000000<br />yend: 0.0000000",null,"x:  33.382763<br />y: 1.0794683<br />xend:  24.000000<br />yend: 1.0794683","x:  33.382763<br />y: 1.0794683<br />xend:  24.000000<br />yend: 1.0794683",null,"x:  24.000000<br />y: 1.0794683<br />xend:  24.000000<br />yend: 0.0000000","x:  24.000000<br />y: 1.0794683<br />xend:  24.000000<br />yend: 0.0000000",null,"x:  33.382763<br />y: 1.0794683<br />xend:  42.765527<br />yend: 1.0794683","x:  33.382763<br />y: 1.0794683<br />xend:  42.765527<br />yend: 1.0794683",null,"x:  42.765527<br />y: 1.0794683<br />xend:  42.765527<br />yend: 1.0298079","x:  42.765527<br />y: 1.0794683<br />xend:  42.765527<br />yend: 1.0298079",null,"x:  42.765527<br />y: 1.0298079<br />xend:  25.500000<br />yend: 1.0298079","x:  42.765527<br />y: 1.0298079<br />xend:  25.500000<br />yend: 1.0298079",null,"x:  25.500000<br />y: 1.0298079<br />xend:  25.500000<br />yend: 0.7714373","x:  25.500000<br />y: 1.0298079<br />xend:  25.500000<br />yend: 0.7714373",null,"x:  42.765527<br />y: 1.0298079<br />xend:  60.031054<br />yend: 1.0298079","x:  42.765527<br />y: 1.0298079<br />xend:  60.031054<br />yend: 1.0298079",null,"x:  60.031054<br />y: 1.0298079<br />xend:  60.031054<br />yend: 0.9848968","x:  60.031054<br />y: 1.0298079<br />xend:  60.031054<br />yend: 0.9848968",null,"x:  25.500000<br />y: 0.7714373<br />xend:  25.000000<br />yend: 0.7714373","x:  25.500000<br />y: 0.7714373<br />xend:  25.000000<br />yend: 0.7714373",null,"x:  25.000000<br />y: 0.7714373<br />xend:  25.000000<br />yend: 0.0000000","x:  25.000000<br />y: 0.7714373<br />xend:  25.000000<br />yend: 0.0000000",null,"x:  25.500000<br />y: 0.7714373<br />xend:  26.000000<br />yend: 0.7714373","x:  25.500000<br />y: 0.7714373<br />xend:  26.000000<br />yend: 0.7714373",null,"x:  26.000000<br />y: 0.7714373<br />xend:  26.000000<br />yend: 0.0000000","x:  26.000000<br />y: 0.7714373<br />xend:  26.000000<br />yend: 0.0000000",null,"x:  60.031054<br />y: 0.9848968<br />xend:  40.016697<br />yend: 0.9848968","x:  60.031054<br />y: 0.9848968<br />xend:  40.016697<br />yend: 0.9848968",null,"x:  40.016697<br />y: 0.9848968<br />xend:  40.016697<br />yend: 0.8996634","x:  40.016697<br />y: 0.9848968<br />xend:  40.016697<br />yend: 0.8996634",null,"x:  60.031054<br />y: 0.9848968<br />xend:  80.045410<br />yend: 0.9848968","x:  60.031054<br />y: 0.9848968<br />xend:  80.045410<br />yend: 0.9848968",null,"x:  80.045410<br />y: 0.9848968<br />xend:  80.045410<br />yend: 0.9662211","x:  80.045410<br />y: 0.9848968<br />xend:  80.045410<br />yend: 0.9662211",null,"x:  40.016697<br />y: 0.8996634<br />xend:  27.750000<br />yend: 0.8996634","x:  40.016697<br />y: 0.8996634<br />xend:  27.750000<br />yend: 0.8996634",null,"x:  27.750000<br />y: 0.8996634<br />xend:  27.750000<br />yend: 0.8579950","x:  27.750000<br />y: 0.8996634<br />xend:  27.750000<br />yend: 0.8579950",null,"x:  40.016697<br />y: 0.8996634<br />xend:  52.283394<br />yend: 0.8996634","x:  40.016697<br />y: 0.8996634<br />xend:  52.283394<br />yend: 0.8996634",null,"x:  52.283394<br />y: 0.8996634<br />xend:  52.283394<br />yend: 0.8597444","x:  52.283394<br />y: 0.8996634<br />xend:  52.283394<br />yend: 0.8597444",null,"x:  27.750000<br />y: 0.8579950<br />xend:  27.000000<br />yend: 0.8579950","x:  27.750000<br />y: 0.8579950<br />xend:  27.000000<br />yend: 0.8579950",null,"x:  27.000000<br />y: 0.8579950<br />xend:  27.000000<br />yend: 0.0000000","x:  27.000000<br />y: 0.8579950<br />xend:  27.000000<br />yend: 0.0000000",null,"x:  27.750000<br />y: 0.8579950<br />xend:  28.500000<br />yend: 0.8579950","x:  27.750000<br />y: 0.8579950<br />xend:  28.500000<br />yend: 0.8579950",null,"x:  28.500000<br />y: 0.8579950<br />xend:  28.500000<br />yend: 0.6947777","x:  28.500000<br />y: 0.8579950<br />xend:  28.500000<br />yend: 0.6947777",null,"x:  28.500000<br />y: 0.6947777<br />xend:  28.000000<br />yend: 0.6947777","x:  28.500000<br />y: 0.6947777<br />xend:  28.000000<br />yend: 0.6947777",null,"x:  28.000000<br />y: 0.6947777<br />xend:  28.000000<br />yend: 0.0000000","x:  28.000000<br />y: 0.6947777<br />xend:  28.000000<br />yend: 0.0000000",null,"x:  28.500000<br />y: 0.6947777<br />xend:  29.000000<br />yend: 0.6947777","x:  28.500000<br />y: 0.6947777<br />xend:  29.000000<br />yend: 0.6947777",null,"x:  29.000000<br />y: 0.6947777<br />xend:  29.000000<br />yend: 0.0000000","x:  29.000000<br />y: 0.6947777<br />xend:  29.000000<br />yend: 0.0000000",null,"x:  52.283394<br />y: 0.8597444<br />xend:  32.816787<br />yend: 0.8597444","x:  52.283394<br />y: 0.8597444<br />xend:  32.816787<br />yend: 0.8597444",null,"x:  32.816787<br />y: 0.8597444<br />xend:  32.816787<br />yend: 0.8133683","x:  32.816787<br />y: 0.8597444<br />xend:  32.816787<br />yend: 0.8133683",null,"x:  52.283394<br />y: 0.8597444<br />xend:  71.750000<br />yend: 0.8597444","x:  52.283394<br />y: 0.8597444<br />xend:  71.750000<br />yend: 0.8597444",null,"x:  71.750000<br />y: 0.8597444<br />xend:  71.750000<br />yend: 0.8277900","x:  71.750000<br />y: 0.8597444<br />xend:  71.750000<br />yend: 0.8277900",null,"x:  32.816787<br />y: 0.8133683<br />xend:  30.000000<br />yend: 0.8133683","x:  32.816787<br />y: 0.8133683<br />xend:  30.000000<br />yend: 0.8133683",null,"x:  30.000000<br />y: 0.8133683<br />xend:  30.000000<br />yend: 0.0000000","x:  30.000000<br />y: 0.8133683<br />xend:  30.000000<br />yend: 0.0000000",null,"x:  32.816787<br />y: 0.8133683<br />xend:  35.633575<br />yend: 0.8133683","x:  32.816787<br />y: 0.8133683<br />xend:  35.633575<br />yend: 0.8133683",null,"x:  35.633575<br />y: 0.8133683<br />xend:  35.633575<br />yend: 0.7457737","x:  35.633575<br />y: 0.8133683<br />xend:  35.633575<br />yend: 0.7457737",null,"x:  35.633575<br />y: 0.7457737<br />xend:  31.968750<br />yend: 0.7457737","x:  35.633575<br />y: 0.7457737<br />xend:  31.968750<br />yend: 0.7457737",null,"x:  31.968750<br />y: 0.7457737<br />xend:  31.968750<br />yend: 0.6937202","x:  31.968750<br />y: 0.7457737<br />xend:  31.968750<br />yend: 0.6937202",null,"x:  35.633575<br />y: 0.7457737<br />xend:  39.298400<br />yend: 0.7457737","x:  35.633575<br />y: 0.7457737<br />xend:  39.298400<br />yend: 0.7457737",null,"x:  39.298400<br />y: 0.7457737<br />xend:  39.298400<br />yend: 0.7373127","x:  39.298400<br />y: 0.7457737<br />xend:  39.298400<br />yend: 0.7373127",null,"x:  31.968750<br />y: 0.6937202<br />xend:  31.000000<br />yend: 0.6937202","x:  31.968750<br />y: 0.6937202<br />xend:  31.000000<br />yend: 0.6937202",null,"x:  31.000000<br />y: 0.6937202<br />xend:  31.000000<br />yend: 0.0000000","x:  31.000000<br />y: 0.6937202<br />xend:  31.000000<br />yend: 0.0000000",null,"x:  31.968750<br />y: 0.6937202<br />xend:  32.937500<br />yend: 0.6937202","x:  31.968750<br />y: 0.6937202<br />xend:  32.937500<br />yend: 0.6937202",null,"x:  32.937500<br />y: 0.6937202<br />xend:  32.937500<br />yend: 0.6703669","x:  32.937500<br />y: 0.6937202<br />xend:  32.937500<br />yend: 0.6703669",null,"x:  32.937500<br />y: 0.6703669<br />xend:  32.000000<br />yend: 0.6703669","x:  32.937500<br />y: 0.6703669<br />xend:  32.000000<br />yend: 0.6703669",null,"x:  32.000000<br />y: 0.6703669<br />xend:  32.000000<br />yend: 0.0000000","x:  32.000000<br />y: 0.6703669<br />xend:  32.000000<br />yend: 0.0000000",null,"x:  32.937500<br />y: 0.6703669<br />xend:  33.875000<br />yend: 0.6703669","x:  32.937500<br />y: 0.6703669<br />xend:  33.875000<br />yend: 0.6703669",null,"x:  33.875000<br />y: 0.6703669<br />xend:  33.875000<br />yend: 0.6465288","x:  33.875000<br />y: 0.6703669<br />xend:  33.875000<br />yend: 0.6465288",null,"x:  33.875000<br />y: 0.6465288<br />xend:  33.000000<br />yend: 0.6465288","x:  33.875000<br />y: 0.6465288<br />xend:  33.000000<br />yend: 0.6465288",null,"x:  33.000000<br />y: 0.6465288<br />xend:  33.000000<br />yend: 0.0000000","x:  33.000000<br />y: 0.6465288<br />xend:  33.000000<br />yend: 0.0000000",null,"x:  33.875000<br />y: 0.6465288<br />xend:  34.750000<br />yend: 0.6465288","x:  33.875000<br />y: 0.6465288<br />xend:  34.750000<br />yend: 0.6465288",null,"x:  34.750000<br />y: 0.6465288<br />xend:  34.750000<br />yend: 0.6221976","x:  34.750000<br />y: 0.6465288<br />xend:  34.750000<br />yend: 0.6221976",null,"x:  34.750000<br />y: 0.6221976<br />xend:  34.000000<br />yend: 0.6221976","x:  34.750000<br />y: 0.6221976<br />xend:  34.000000<br />yend: 0.6221976",null,"x:  34.000000<br />y: 0.6221976<br />xend:  34.000000<br />yend: 0.0000000","x:  34.000000<br />y: 0.6221976<br />xend:  34.000000<br />yend: 0.0000000",null,"x:  34.750000<br />y: 0.6221976<br />xend:  35.500000<br />yend: 0.6221976","x:  34.750000<br />y: 0.6221976<br />xend:  35.500000<br />yend: 0.6221976",null,"x:  35.500000<br />y: 0.6221976<br />xend:  35.500000<br />yend: 0.5659698","x:  35.500000<br />y: 0.6221976<br />xend:  35.500000<br />yend: 0.5659698",null,"x:  35.500000<br />y: 0.5659698<br />xend:  35.000000<br />yend: 0.5659698","x:  35.500000<br />y: 0.5659698<br />xend:  35.000000<br />yend: 0.5659698",null,"x:  35.000000<br />y: 0.5659698<br />xend:  35.000000<br />yend: 0.0000000","x:  35.000000<br />y: 0.5659698<br />xend:  35.000000<br />yend: 0.0000000",null,"x:  35.500000<br />y: 0.5659698<br />xend:  36.000000<br />yend: 0.5659698","x:  35.500000<br />y: 0.5659698<br />xend:  36.000000<br />yend: 0.5659698",null,"x:  36.000000<br />y: 0.5659698<br />xend:  36.000000<br />yend: 0.0000000","x:  36.000000<br />y: 0.5659698<br />xend:  36.000000<br />yend: 0.0000000",null,"x:  39.298400<br />y: 0.7373127<br />xend:  37.500000<br />yend: 0.7373127","x:  39.298400<br />y: 0.7373127<br />xend:  37.500000<br />yend: 0.7373127",null,"x:  37.500000<br />y: 0.7373127<br />xend:  37.500000<br />yend: 0.6941607","x:  37.500000<br />y: 0.7373127<br />xend:  37.500000<br />yend: 0.6941607",null,"x:  39.298400<br />y: 0.7373127<br />xend:  41.096800<br />yend: 0.7373127","x:  39.298400<br />y: 0.7373127<br />xend:  41.096800<br />yend: 0.7373127",null,"x:  41.096800<br />y: 0.7373127<br />xend:  41.096800<br />yend: 0.7341967","x:  41.096800<br />y: 0.7373127<br />xend:  41.096800<br />yend: 0.7341967",null,"x:  37.500000<br />y: 0.6941607<br />xend:  37.000000<br />yend: 0.6941607","x:  37.500000<br />y: 0.6941607<br />xend:  37.000000<br />yend: 0.6941607",null,"x:  37.000000<br />y: 0.6941607<br />xend:  37.000000<br />yend: 0.0000000","x:  37.000000<br />y: 0.6941607<br />xend:  37.000000<br />yend: 0.0000000",null,"x:  37.500000<br />y: 0.6941607<br />xend:  38.000000<br />yend: 0.6941607","x:  37.500000<br />y: 0.6941607<br />xend:  38.000000<br />yend: 0.6941607",null,"x:  38.000000<br />y: 0.6941607<br />xend:  38.000000<br />yend: 0.0000000","x:  38.000000<br />y: 0.6941607<br />xend:  38.000000<br />yend: 0.0000000",null,"x:  41.096800<br />y: 0.7341967<br />xend:  39.000000<br />yend: 0.7341967","x:  41.096800<br />y: 0.7341967<br />xend:  39.000000<br />yend: 0.7341967",null,"x:  39.000000<br />y: 0.7341967<br />xend:  39.000000<br />yend: 0.0000000","x:  39.000000<br />y: 0.7341967<br />xend:  39.000000<br />yend: 0.0000000",null,"x:  41.096800<br />y: 0.7341967<br />xend:  43.193600<br />yend: 0.7341967","x:  41.096800<br />y: 0.7341967<br />xend:  43.193600<br />yend: 0.7341967",null,"x:  43.193600<br />y: 0.7341967<br />xend:  43.193600<br />yend: 0.7165436","x:  43.193600<br />y: 0.7341967<br />xend:  43.193600<br />yend: 0.7165436",null,"x:  43.193600<br />y: 0.7165436<br />xend:  40.000000<br />yend: 0.7165436","x:  43.193600<br />y: 0.7165436<br />xend:  40.000000<br />yend: 0.7165436",null,"x:  40.000000<br />y: 0.7165436<br />xend:  40.000000<br />yend: 0.0000000","x:  40.000000<br />y: 0.7165436<br />xend:  40.000000<br />yend: 0.0000000",null,"x:  43.193600<br />y: 0.7165436<br />xend:  46.387199<br />yend: 0.7165436","x:  43.193600<br />y: 0.7165436<br />xend:  46.387199<br />yend: 0.7165436",null,"x:  46.387199<br />y: 0.7165436<br />xend:  46.387199<br />yend: 0.7004929","x:  46.387199<br />y: 0.7165436<br />xend:  46.387199<br />yend: 0.7004929",null,"x:  46.387199<br />y: 0.7004929<br />xend:  42.625000<br />yend: 0.7004929","x:  46.387199<br />y: 0.7004929<br />xend:  42.625000<br />yend: 0.7004929",null,"x:  42.625000<br />y: 0.7004929<br />xend:  42.625000<br />yend: 0.6445239","x:  42.625000<br />y: 0.7004929<br />xend:  42.625000<br />yend: 0.6445239",null,"x:  46.387199<br />y: 0.7004929<br />xend:  50.149399<br />yend: 0.7004929","x:  46.387199<br />y: 0.7004929<br />xend:  50.149399<br />yend: 0.7004929",null,"x:  50.149399<br />y: 0.7004929<br />xend:  50.149399<br />yend: 0.6694253","x:  50.149399<br />y: 0.7004929<br />xend:  50.149399<br />yend: 0.6694253",null,"x:  42.625000<br />y: 0.6445239<br />xend:  41.000000<br />yend: 0.6445239","x:  42.625000<br />y: 0.6445239<br />xend:  41.000000<br />yend: 0.6445239",null,"x:  41.000000<br />y: 0.6445239<br />xend:  41.000000<br />yend: 0.0000000","x:  41.000000<br />y: 0.6445239<br />xend:  41.000000<br />yend: 0.0000000",null,"x:  42.625000<br />y: 0.6445239<br />xend:  44.250000<br />yend: 0.6445239","x:  42.625000<br />y: 0.6445239<br />xend:  44.250000<br />yend: 0.6445239",null,"x:  44.250000<br />y: 0.6445239<br />xend:  44.250000<br />yend: 0.5990662","x:  44.250000<br />y: 0.6445239<br />xend:  44.250000<br />yend: 0.5990662",null,"x:  44.250000<br />y: 0.5990662<br />xend:  42.750000<br />yend: 0.5990662","x:  44.250000<br />y: 0.5990662<br />xend:  42.750000<br />yend: 0.5990662",null,"x:  42.750000<br />y: 0.5990662<br />xend:  42.750000<br />yend: 0.5391128","x:  42.750000<br />y: 0.5990662<br />xend:  42.750000<br />yend: 0.5391128",null,"x:  44.250000<br />y: 0.5990662<br />xend:  45.750000<br />yend: 0.5990662","x:  44.250000<br />y: 0.5990662<br />xend:  45.750000<br />yend: 0.5990662",null,"x:  45.750000<br />y: 0.5990662<br />xend:  45.750000<br />yend: 0.5702605","x:  45.750000<br />y: 0.5990662<br />xend:  45.750000<br />yend: 0.5702605",null,"x:  42.750000<br />y: 0.5391128<br />xend:  42.000000<br />yend: 0.5391128","x:  42.750000<br />y: 0.5391128<br />xend:  42.000000<br />yend: 0.5391128",null,"x:  42.000000<br />y: 0.5391128<br />xend:  42.000000<br />yend: 0.0000000","x:  42.000000<br />y: 0.5391128<br />xend:  42.000000<br />yend: 0.0000000",null,"x:  42.750000<br />y: 0.5391128<br />xend:  43.500000<br />yend: 0.5391128","x:  42.750000<br />y: 0.5391128<br />xend:  43.500000<br />yend: 0.5391128",null,"x:  43.500000<br />y: 0.5391128<br />xend:  43.500000<br />yend: 0.0000000","x:  43.500000<br />y: 0.5391128<br />xend:  43.500000<br />yend: 0.0000000",null,"x:  43.500000<br />y: 0.0000000<br />xend:  43.000000<br />yend: 0.0000000","x:  43.500000<br />y: 0.0000000<br />xend:  43.000000<br />yend: 0.0000000",null,"x:  43.000000<br />y: 0.0000000<br />xend:  43.000000<br />yend: 0.0000000","x:  43.000000<br />y: 0.0000000<br />xend:  43.000000<br />yend: 0.0000000",null,"x:  43.500000<br />y: 0.0000000<br />xend:  44.000000<br />yend: 0.0000000","x:  43.500000<br />y: 0.0000000<br />xend:  44.000000<br />yend: 0.0000000",null,"x:  44.000000<br />y: 0.0000000<br />xend:  44.000000<br />yend: 0.0000000","x:  44.000000<br />y: 0.0000000<br />xend:  44.000000<br />yend: 0.0000000",null,"x:  45.750000<br />y: 0.5702605<br />xend:  45.000000<br />yend: 0.5702605","x:  45.750000<br />y: 0.5702605<br />xend:  45.000000<br />yend: 0.5702605",null,"x:  45.000000<br />y: 0.5702605<br />xend:  45.000000<br />yend: 0.0000000","x:  45.000000<br />y: 0.5702605<br />xend:  45.000000<br />yend: 0.0000000",null,"x:  45.750000<br />y: 0.5702605<br />xend:  46.500000<br />yend: 0.5702605","x:  45.750000<br />y: 0.5702605<br />xend:  46.500000<br />yend: 0.5702605",null,"x:  46.500000<br />y: 0.5702605<br />xend:  46.500000<br />yend: 0.4764394","x:  46.500000<br />y: 0.5702605<br />xend:  46.500000<br />yend: 0.4764394",null,"x:  46.500000<br />y: 0.4764394<br />xend:  46.000000<br />yend: 0.4764394","x:  46.500000<br />y: 0.4764394<br />xend:  46.000000<br />yend: 0.4764394",null,"x:  46.000000<br />y: 0.4764394<br />xend:  46.000000<br />yend: 0.0000000","x:  46.000000<br />y: 0.4764394<br />xend:  46.000000<br />yend: 0.0000000",null,"x:  46.500000<br />y: 0.4764394<br />xend:  47.000000<br />yend: 0.4764394","x:  46.500000<br />y: 0.4764394<br />xend:  47.000000<br />yend: 0.4764394",null,"x:  47.000000<br />y: 0.4764394<br />xend:  47.000000<br />yend: 0.0000000","x:  47.000000<br />y: 0.4764394<br />xend:  47.000000<br />yend: 0.0000000",null,"x:  50.149399<br />y: 0.6694253<br />xend:  48.000000<br />yend: 0.6694253","x:  50.149399<br />y: 0.6694253<br />xend:  48.000000<br />yend: 0.6694253",null,"x:  48.000000<br />y: 0.6694253<br />xend:  48.000000<br />yend: 0.0000000","x:  48.000000<br />y: 0.6694253<br />xend:  48.000000<br />yend: 0.0000000",null,"x:  50.149399<br />y: 0.6694253<br />xend:  52.298798<br />yend: 0.6694253","x:  50.149399<br />y: 0.6694253<br />xend:  52.298798<br />yend: 0.6694253",null,"x:  52.298798<br />y: 0.6694253<br />xend:  52.298798<br />yend: 0.6649469","x:  52.298798<br />y: 0.6694253<br />xend:  52.298798<br />yend: 0.6649469",null,"x:  52.298798<br />y: 0.6649469<br />xend:  49.500000<br />yend: 0.6649469","x:  52.298798<br />y: 0.6649469<br />xend:  49.500000<br />yend: 0.6649469",null,"x:  49.500000<br />y: 0.6649469<br />xend:  49.500000<br />yend: 0.6101256","x:  49.500000<br />y: 0.6649469<br />xend:  49.500000<br />yend: 0.6101256",null,"x:  52.298798<br />y: 0.6649469<br />xend:  55.097595<br />yend: 0.6649469","x:  52.298798<br />y: 0.6649469<br />xend:  55.097595<br />yend: 0.6649469",null,"x:  55.097595<br />y: 0.6649469<br />xend:  55.097595<br />yend: 0.6454429","x:  55.097595<br />y: 0.6649469<br />xend:  55.097595<br />yend: 0.6454429",null,"x:  49.500000<br />y: 0.6101256<br />xend:  49.000000<br />yend: 0.6101256","x:  49.500000<br />y: 0.6101256<br />xend:  49.000000<br />yend: 0.6101256",null,"x:  49.000000<br />y: 0.6101256<br />xend:  49.000000<br />yend: 0.0000000","x:  49.000000<br />y: 0.6101256<br />xend:  49.000000<br />yend: 0.0000000",null,"x:  49.500000<br />y: 0.6101256<br />xend:  50.000000<br />yend: 0.6101256","x:  49.500000<br />y: 0.6101256<br />xend:  50.000000<br />yend: 0.6101256",null,"x:  50.000000<br />y: 0.6101256<br />xend:  50.000000<br />yend: 0.0000000","x:  50.000000<br />y: 0.6101256<br />xend:  50.000000<br />yend: 0.0000000",null,"x:  55.097595<br />y: 0.6454429<br />xend:  51.750000<br />yend: 0.6454429","x:  55.097595<br />y: 0.6454429<br />xend:  51.750000<br />yend: 0.6454429",null,"x:  51.750000<br />y: 0.6454429<br />xend:  51.750000<br />yend: 0.5076455","x:  51.750000<br />y: 0.6454429<br />xend:  51.750000<br />yend: 0.5076455",null,"x:  55.097595<br />y: 0.6454429<br />xend:  58.445190<br />yend: 0.6454429","x:  55.097595<br />y: 0.6454429<br />xend:  58.445190<br />yend: 0.6454429",null,"x:  58.445190<br />y: 0.6454429<br />xend:  58.445190<br />yend: 0.6293722","x:  58.445190<br />y: 0.6454429<br />xend:  58.445190<br />yend: 0.6293722",null,"x:  51.750000<br />y: 0.5076455<br />xend:  51.000000<br />yend: 0.5076455","x:  51.750000<br />y: 0.5076455<br />xend:  51.000000<br />yend: 0.5076455",null,"x:  51.000000<br />y: 0.5076455<br />xend:  51.000000<br />yend: 0.0000000","x:  51.000000<br />y: 0.5076455<br />xend:  51.000000<br />yend: 0.0000000",null,"x:  51.750000<br />y: 0.5076455<br />xend:  52.500000<br />yend: 0.5076455","x:  51.750000<br />y: 0.5076455<br />xend:  52.500000<br />yend: 0.5076455",null,"x:  52.500000<br />y: 0.5076455<br />xend:  52.500000<br />yend: 0.4295574","x:  52.500000<br />y: 0.5076455<br />xend:  52.500000<br />yend: 0.4295574",null,"x:  52.500000<br />y: 0.4295574<br />xend:  52.000000<br />yend: 0.4295574","x:  52.500000<br />y: 0.4295574<br />xend:  52.000000<br />yend: 0.4295574",null,"x:  52.000000<br />y: 0.4295574<br />xend:  52.000000<br />yend: 0.0000000","x:  52.000000<br />y: 0.4295574<br />xend:  52.000000<br />yend: 0.0000000",null,"x:  52.500000<br />y: 0.4295574<br />xend:  53.000000<br />yend: 0.4295574","x:  52.500000<br />y: 0.4295574<br />xend:  53.000000<br />yend: 0.4295574",null,"x:  53.000000<br />y: 0.4295574<br />xend:  53.000000<br />yend: 0.0000000","x:  53.000000<br />y: 0.4295574<br />xend:  53.000000<br />yend: 0.0000000",null,"x:  58.445190<br />y: 0.6293722<br />xend:  54.000000<br />yend: 0.6293722","x:  58.445190<br />y: 0.6293722<br />xend:  54.000000<br />yend: 0.6293722",null,"x:  54.000000<br />y: 0.6293722<br />xend:  54.000000<br />yend: 0.0000000","x:  54.000000<br />y: 0.6293722<br />xend:  54.000000<br />yend: 0.0000000",null,"x:  58.445190<br />y: 0.6293722<br />xend:  62.890381<br />yend: 0.6293722","x:  58.445190<br />y: 0.6293722<br />xend:  62.890381<br />yend: 0.6293722",null,"x:  62.890381<br />y: 0.6293722<br />xend:  62.890381<br />yend: 0.6197188","x:  62.890381<br />y: 0.6293722<br />xend:  62.890381<br />yend: 0.6197188",null,"x:  62.890381<br />y: 0.6197188<br />xend:  56.280762<br />yend: 0.6197188","x:  62.890381<br />y: 0.6197188<br />xend:  56.280762<br />yend: 0.6197188",null,"x:  56.280762<br />y: 0.6197188<br />xend:  56.280762<br />yend: 0.5312699","x:  56.280762<br />y: 0.6197188<br />xend:  56.280762<br />yend: 0.5312699",null,"x:  62.890381<br />y: 0.6197188<br />xend:  69.500000<br />yend: 0.6197188","x:  62.890381<br />y: 0.6197188<br />xend:  69.500000<br />yend: 0.6197188",null,"x:  69.500000<br />y: 0.6197188<br />xend:  69.500000<br />yend: 0.5963647","x:  69.500000<br />y: 0.6197188<br />xend:  69.500000<br />yend: 0.5963647",null,"x:  56.280762<br />y: 0.5312699<br />xend:  55.000000<br />yend: 0.5312699","x:  56.280762<br />y: 0.5312699<br />xend:  55.000000<br />yend: 0.5312699",null,"x:  55.000000<br />y: 0.5312699<br />xend:  55.000000<br />yend: 0.0000000","x:  55.000000<br />y: 0.5312699<br />xend:  55.000000<br />yend: 0.0000000",null,"x:  56.280762<br />y: 0.5312699<br />xend:  57.561523<br />yend: 0.5312699","x:  56.280762<br />y: 0.5312699<br />xend:  57.561523<br />yend: 0.5312699",null,"x:  57.561523<br />y: 0.5312699<br />xend:  57.561523<br />yend: 0.5284724","x:  57.561523<br />y: 0.5312699<br />xend:  57.561523<br />yend: 0.5284724",null,"x:  57.561523<br />y: 0.5284724<br />xend:  56.000000<br />yend: 0.5284724","x:  57.561523<br />y: 0.5284724<br />xend:  56.000000<br />yend: 0.5284724",null,"x:  56.000000<br />y: 0.5284724<br />xend:  56.000000<br />yend: 0.0000000","x:  56.000000<br />y: 0.5284724<br />xend:  56.000000<br />yend: 0.0000000",null,"x:  57.561523<br />y: 0.5284724<br />xend:  59.123047<br />yend: 0.5284724","x:  57.561523<br />y: 0.5284724<br />xend:  59.123047<br />yend: 0.5284724",null,"x:  59.123047<br />y: 0.5284724<br />xend:  59.123047<br />yend: 0.5095062","x:  59.123047<br />y: 0.5284724<br />xend:  59.123047<br />yend: 0.5095062",null,"x:  59.123047<br />y: 0.5095062<br />xend:  57.500000<br />yend: 0.5095062","x:  59.123047<br />y: 0.5095062<br />xend:  57.500000<br />yend: 0.5095062",null,"x:  57.500000<br />y: 0.5095062<br />xend:  57.500000<br />yend: 0.4676110","x:  57.500000<br />y: 0.5095062<br />xend:  57.500000<br />yend: 0.4676110",null,"x:  59.123047<br />y: 0.5095062<br />xend:  60.746094<br />yend: 0.5095062","x:  59.123047<br />y: 0.5095062<br />xend:  60.746094<br />yend: 0.5095062",null,"x:  60.746094<br />y: 0.5095062<br />xend:  60.746094<br />yend: 0.4959488","x:  60.746094<br />y: 0.5095062<br />xend:  60.746094<br />yend: 0.4959488",null,"x:  57.500000<br />y: 0.4676110<br />xend:  57.000000<br />yend: 0.4676110","x:  57.500000<br />y: 0.4676110<br />xend:  57.000000<br />yend: 0.4676110",null,"x:  57.000000<br />y: 0.4676110<br />xend:  57.000000<br />yend: 0.0000000","x:  57.000000<br />y: 0.4676110<br />xend:  57.000000<br />yend: 0.0000000",null,"x:  57.500000<br />y: 0.4676110<br />xend:  58.000000<br />yend: 0.4676110","x:  57.500000<br />y: 0.4676110<br />xend:  58.000000<br />yend: 0.4676110",null,"x:  58.000000<br />y: 0.4676110<br />xend:  58.000000<br />yend: 0.0000000","x:  58.000000<br />y: 0.4676110<br />xend:  58.000000<br />yend: 0.0000000",null,"x:  60.746094<br />y: 0.4959488<br />xend:  59.500000<br />yend: 0.4959488","x:  60.746094<br />y: 0.4959488<br />xend:  59.500000<br />yend: 0.4959488",null,"x:  59.500000<br />y: 0.4959488<br />xend:  59.500000<br />yend: 0.4553230","x:  59.500000<br />y: 0.4959488<br />xend:  59.500000<br />yend: 0.4553230",null,"x:  60.746094<br />y: 0.4959488<br />xend:  61.992188<br />yend: 0.4959488","x:  60.746094<br />y: 0.4959488<br />xend:  61.992188<br />yend: 0.4959488",null,"x:  61.992188<br />y: 0.4959488<br />xend:  61.992188<br />yend: 0.4641018","x:  61.992188<br />y: 0.4959488<br />xend:  61.992188<br />yend: 0.4641018",null,"x:  59.500000<br />y: 0.4553230<br />xend:  59.000000<br />yend: 0.4553230","x:  59.500000<br />y: 0.4553230<br />xend:  59.000000<br />yend: 0.4553230",null,"x:  59.000000<br />y: 0.4553230<br />xend:  59.000000<br />yend: 0.0000000","x:  59.000000<br />y: 0.4553230<br />xend:  59.000000<br />yend: 0.0000000",null,"x:  59.500000<br />y: 0.4553230<br />xend:  60.000000<br />yend: 0.4553230","x:  59.500000<br />y: 0.4553230<br />xend:  60.000000<br />yend: 0.4553230",null,"x:  60.000000<br />y: 0.4553230<br />xend:  60.000000<br />yend: 0.0000000","x:  60.000000<br />y: 0.4553230<br />xend:  60.000000<br />yend: 0.0000000",null,"x:  61.992188<br />y: 0.4641018<br />xend:  61.000000<br />yend: 0.4641018","x:  61.992188<br />y: 0.4641018<br />xend:  61.000000<br />yend: 0.4641018",null,"x:  61.000000<br />y: 0.4641018<br />xend:  61.000000<br />yend: 0.0000000","x:  61.000000<br />y: 0.4641018<br />xend:  61.000000<br />yend: 0.0000000",null,"x:  61.992188<br />y: 0.4641018<br />xend:  62.984375<br />yend: 0.4641018","x:  61.992188<br />y: 0.4641018<br />xend:  62.984375<br />yend: 0.4641018",null,"x:  62.984375<br />y: 0.4641018<br />xend:  62.984375<br />yend: 0.4512235","x:  62.984375<br />y: 0.4641018<br />xend:  62.984375<br />yend: 0.4512235",null,"x:  62.984375<br />y: 0.4512235<br />xend:  62.000000<br />yend: 0.4512235","x:  62.984375<br />y: 0.4512235<br />xend:  62.000000<br />yend: 0.4512235",null,"x:  62.000000<br />y: 0.4512235<br />xend:  62.000000<br />yend: 0.0000000","x:  62.000000<br />y: 0.4512235<br />xend:  62.000000<br />yend: 0.0000000",null,"x:  62.984375<br />y: 0.4512235<br />xend:  63.968750<br />yend: 0.4512235","x:  62.984375<br />y: 0.4512235<br />xend:  63.968750<br />yend: 0.4512235",null,"x:  63.968750<br />y: 0.4512235<br />xend:  63.968750<br />yend: 0.4271213","x:  63.968750<br />y: 0.4512235<br />xend:  63.968750<br />yend: 0.4271213",null,"x:  63.968750<br />y: 0.4271213<br />xend:  63.000000<br />yend: 0.4271213","x:  63.968750<br />y: 0.4271213<br />xend:  63.000000<br />yend: 0.4271213",null,"x:  63.000000<br />y: 0.4271213<br />xend:  63.000000<br />yend: 0.0000000","x:  63.000000<br />y: 0.4271213<br />xend:  63.000000<br />yend: 0.0000000",null,"x:  63.968750<br />y: 0.4271213<br />xend:  64.937500<br />yend: 0.4271213","x:  63.968750<br />y: 0.4271213<br />xend:  64.937500<br />yend: 0.4271213",null,"x:  64.937500<br />y: 0.4271213<br />xend:  64.937500<br />yend: 0.4155568","x:  64.937500<br />y: 0.4271213<br />xend:  64.937500<br />yend: 0.4155568",null,"x:  64.937500<br />y: 0.4155568<br />xend:  64.000000<br />yend: 0.4155568","x:  64.937500<br />y: 0.4155568<br />xend:  64.000000<br />yend: 0.4155568",null,"x:  64.000000<br />y: 0.4155568<br />xend:  64.000000<br />yend: 0.0000000","x:  64.000000<br />y: 0.4155568<br />xend:  64.000000<br />yend: 0.0000000",null,"x:  64.937500<br />y: 0.4155568<br />xend:  65.875000<br />yend: 0.4155568","x:  64.937500<br />y: 0.4155568<br />xend:  65.875000<br />yend: 0.4155568",null,"x:  65.875000<br />y: 0.4155568<br />xend:  65.875000<br />yend: 0.3765803","x:  65.875000<br />y: 0.4155568<br />xend:  65.875000<br />yend: 0.3765803",null,"x:  65.875000<br />y: 0.3765803<br />xend:  65.000000<br />yend: 0.3765803","x:  65.875000<br />y: 0.3765803<br />xend:  65.000000<br />yend: 0.3765803",null,"x:  65.000000<br />y: 0.3765803<br />xend:  65.000000<br />yend: 0.0000000","x:  65.000000<br />y: 0.3765803<br />xend:  65.000000<br />yend: 0.0000000",null,"x:  65.875000<br />y: 0.3765803<br />xend:  66.750000<br />yend: 0.3765803","x:  65.875000<br />y: 0.3765803<br />xend:  66.750000<br />yend: 0.3765803",null,"x:  66.750000<br />y: 0.3765803<br />xend:  66.750000<br />yend: 0.3592486","x:  66.750000<br />y: 0.3765803<br />xend:  66.750000<br />yend: 0.3592486",null,"x:  66.750000<br />y: 0.3592486<br />xend:  66.000000<br />yend: 0.3592486","x:  66.750000<br />y: 0.3592486<br />xend:  66.000000<br />yend: 0.3592486",null,"x:  66.000000<br />y: 0.3592486<br />xend:  66.000000<br />yend: 0.0000000","x:  66.000000<br />y: 0.3592486<br />xend:  66.000000<br />yend: 0.0000000",null,"x:  66.750000<br />y: 0.3592486<br />xend:  67.500000<br />yend: 0.3592486","x:  66.750000<br />y: 0.3592486<br />xend:  67.500000<br />yend: 0.3592486",null,"x:  67.500000<br />y: 0.3592486<br />xend:  67.500000<br />yend: 0.3427298","x:  67.500000<br />y: 0.3592486<br />xend:  67.500000<br />yend: 0.3427298",null,"x:  67.500000<br />y: 0.3427298<br />xend:  67.000000<br />yend: 0.3427298","x:  67.500000<br />y: 0.3427298<br />xend:  67.000000<br />yend: 0.3427298",null,"x:  67.000000<br />y: 0.3427298<br />xend:  67.000000<br />yend: 0.0000000","x:  67.000000<br />y: 0.3427298<br />xend:  67.000000<br />yend: 0.0000000",null,"x:  67.500000<br />y: 0.3427298<br />xend:  68.000000<br />yend: 0.3427298","x:  67.500000<br />y: 0.3427298<br />xend:  68.000000<br />yend: 0.3427298",null,"x:  68.000000<br />y: 0.3427298<br />xend:  68.000000<br />yend: 0.0000000","x:  68.000000<br />y: 0.3427298<br />xend:  68.000000<br />yend: 0.0000000",null,"x:  69.500000<br />y: 0.5963647<br />xend:  69.000000<br />yend: 0.5963647","x:  69.500000<br />y: 0.5963647<br />xend:  69.000000<br />yend: 0.5963647",null,"x:  69.000000<br />y: 0.5963647<br />xend:  69.000000<br />yend: 0.0000000","x:  69.000000<br />y: 0.5963647<br />xend:  69.000000<br />yend: 0.0000000",null,"x:  69.500000<br />y: 0.5963647<br />xend:  70.000000<br />yend: 0.5963647","x:  69.500000<br />y: 0.5963647<br />xend:  70.000000<br />yend: 0.5963647",null,"x:  70.000000<br />y: 0.5963647<br />xend:  70.000000<br />yend: 0.0000000","x:  70.000000<br />y: 0.5963647<br />xend:  70.000000<br />yend: 0.0000000",null,"x:  71.750000<br />y: 0.8277900<br />xend:  71.000000<br />yend: 0.8277900","x:  71.750000<br />y: 0.8277900<br />xend:  71.000000<br />yend: 0.8277900",null,"x:  71.000000<br />y: 0.8277900<br />xend:  71.000000<br />yend: 0.0000000","x:  71.000000<br />y: 0.8277900<br />xend:  71.000000<br />yend: 0.0000000",null,"x:  71.750000<br />y: 0.8277900<br />xend:  72.500000<br />yend: 0.8277900","x:  71.750000<br />y: 0.8277900<br />xend:  72.500000<br />yend: 0.8277900",null,"x:  72.500000<br />y: 0.8277900<br />xend:  72.500000<br />yend: 0.7637729","x:  72.500000<br />y: 0.8277900<br />xend:  72.500000<br />yend: 0.7637729",null,"x:  72.500000<br />y: 0.7637729<br />xend:  72.000000<br />yend: 0.7637729","x:  72.500000<br />y: 0.7637729<br />xend:  72.000000<br />yend: 0.7637729",null,"x:  72.000000<br />y: 0.7637729<br />xend:  72.000000<br />yend: 0.0000000","x:  72.000000<br />y: 0.7637729<br />xend:  72.000000<br />yend: 0.0000000",null,"x:  72.500000<br />y: 0.7637729<br />xend:  73.000000<br />yend: 0.7637729","x:  72.500000<br />y: 0.7637729<br />xend:  73.000000<br />yend: 0.7637729",null,"x:  73.000000<br />y: 0.7637729<br />xend:  73.000000<br />yend: 0.0000000","x:  73.000000<br />y: 0.7637729<br />xend:  73.000000<br />yend: 0.0000000",null,"x:  80.045410<br />y: 0.9662211<br />xend:  76.343750<br />yend: 0.9662211","x:  80.045410<br />y: 0.9662211<br />xend:  76.343750<br />yend: 0.9662211",null,"x:  76.343750<br />y: 0.9662211<br />xend:  76.343750<br />yend: 0.9042235","x:  76.343750<br />y: 0.9662211<br />xend:  76.343750<br />yend: 0.9042235",null,"x:  80.045410<br />y: 0.9662211<br />xend:  83.747070<br />yend: 0.9662211","x:  80.045410<br />y: 0.9662211<br />xend:  83.747070<br />yend: 0.9662211",null,"x:  83.747070<br />y: 0.9662211<br />xend:  83.747070<br />yend: 0.9136121","x:  83.747070<br />y: 0.9662211<br />xend:  83.747070<br />yend: 0.9136121",null,"x:  76.343750<br />y: 0.9042235<br />xend:  74.750000<br />yend: 0.9042235","x:  76.343750<br />y: 0.9042235<br />xend:  74.750000<br />yend: 0.9042235",null,"x:  74.750000<br />y: 0.9042235<br />xend:  74.750000<br />yend: 0.7198026","x:  74.750000<br />y: 0.9042235<br />xend:  74.750000<br />yend: 0.7198026",null,"x:  76.343750<br />y: 0.9042235<br />xend:  77.937500<br />yend: 0.9042235","x:  76.343750<br />y: 0.9042235<br />xend:  77.937500<br />yend: 0.9042235",null,"x:  77.937500<br />y: 0.9042235<br />xend:  77.937500<br />yend: 0.7614670","x:  77.937500<br />y: 0.9042235<br />xend:  77.937500<br />yend: 0.7614670",null,"x:  74.750000<br />y: 0.7198026<br />xend:  74.000000<br />yend: 0.7198026","x:  74.750000<br />y: 0.7198026<br />xend:  74.000000<br />yend: 0.7198026",null,"x:  74.000000<br />y: 0.7198026<br />xend:  74.000000<br />yend: 0.0000000","x:  74.000000<br />y: 0.7198026<br />xend:  74.000000<br />yend: 0.0000000",null,"x:  74.750000<br />y: 0.7198026<br />xend:  75.500000<br />yend: 0.7198026","x:  74.750000<br />y: 0.7198026<br />xend:  75.500000<br />yend: 0.7198026",null,"x:  75.500000<br />y: 0.7198026<br />xend:  75.500000<br />yend: 0.5343903","x:  75.500000<br />y: 0.7198026<br />xend:  75.500000<br />yend: 0.5343903",null,"x:  75.500000<br />y: 0.5343903<br />xend:  75.000000<br />yend: 0.5343903","x:  75.500000<br />y: 0.5343903<br />xend:  75.000000<br />yend: 0.5343903",null,"x:  75.000000<br />y: 0.5343903<br />xend:  75.000000<br />yend: 0.0000000","x:  75.000000<br />y: 0.5343903<br />xend:  75.000000<br />yend: 0.0000000",null,"x:  75.500000<br />y: 0.5343903<br />xend:  76.000000<br />yend: 0.5343903","x:  75.500000<br />y: 0.5343903<br />xend:  76.000000<br />yend: 0.5343903",null,"x:  76.000000<br />y: 0.5343903<br />xend:  76.000000<br />yend: 0.0000000","x:  76.000000<br />y: 0.5343903<br />xend:  76.000000<br />yend: 0.0000000",null,"x:  77.937500<br />y: 0.7614670<br />xend:  77.000000<br />yend: 0.7614670","x:  77.937500<br />y: 0.7614670<br />xend:  77.000000<br />yend: 0.7614670",null,"x:  77.000000<br />y: 0.7614670<br />xend:  77.000000<br />yend: 0.0000000","x:  77.000000<br />y: 0.7614670<br />xend:  77.000000<br />yend: 0.0000000",null,"x:  77.937500<br />y: 0.7614670<br />xend:  78.875000<br />yend: 0.7614670","x:  77.937500<br />y: 0.7614670<br />xend:  78.875000<br />yend: 0.7614670",null,"x:  78.875000<br />y: 0.7614670<br />xend:  78.875000<br />yend: 0.6553494","x:  78.875000<br />y: 0.7614670<br />xend:  78.875000<br />yend: 0.6553494",null,"x:  78.875000<br />y: 0.6553494<br />xend:  78.000000<br />yend: 0.6553494","x:  78.875000<br />y: 0.6553494<br />xend:  78.000000<br />yend: 0.6553494",null,"x:  78.000000<br />y: 0.6553494<br />xend:  78.000000<br />yend: 0.0000000","x:  78.000000<br />y: 0.6553494<br />xend:  78.000000<br />yend: 0.0000000",null,"x:  78.875000<br />y: 0.6553494<br />xend:  79.750000<br />yend: 0.6553494","x:  78.875000<br />y: 0.6553494<br />xend:  79.750000<br />yend: 0.6553494",null,"x:  79.750000<br />y: 0.6553494<br />xend:  79.750000<br />yend: 0.6228844","x:  79.750000<br />y: 0.6553494<br />xend:  79.750000<br />yend: 0.6228844",null,"x:  79.750000<br />y: 0.6228844<br />xend:  79.000000<br />yend: 0.6228844","x:  79.750000<br />y: 0.6228844<br />xend:  79.000000<br />yend: 0.6228844",null,"x:  79.000000<br />y: 0.6228844<br />xend:  79.000000<br />yend: 0.0000000","x:  79.000000<br />y: 0.6228844<br />xend:  79.000000<br />yend: 0.0000000",null,"x:  79.750000<br />y: 0.6228844<br />xend:  80.500000<br />yend: 0.6228844","x:  79.750000<br />y: 0.6228844<br />xend:  80.500000<br />yend: 0.6228844",null,"x:  80.500000<br />y: 0.6228844<br />xend:  80.500000<br />yend: 0.6033933","x:  80.500000<br />y: 0.6228844<br />xend:  80.500000<br />yend: 0.6033933",null,"x:  80.500000<br />y: 0.6033933<br />xend:  80.000000<br />yend: 0.6033933","x:  80.500000<br />y: 0.6033933<br />xend:  80.000000<br />yend: 0.6033933",null,"x:  80.000000<br />y: 0.6033933<br />xend:  80.000000<br />yend: 0.0000000","x:  80.000000<br />y: 0.6033933<br />xend:  80.000000<br />yend: 0.0000000",null,"x:  80.500000<br />y: 0.6033933<br />xend:  81.000000<br />yend: 0.6033933","x:  80.500000<br />y: 0.6033933<br />xend:  81.000000<br />yend: 0.6033933",null,"x:  81.000000<br />y: 0.6033933<br />xend:  81.000000<br />yend: 0.0000000","x:  81.000000<br />y: 0.6033933<br />xend:  81.000000<br />yend: 0.0000000",null,"x:  83.747070<br />y: 0.9136121<br />xend:  82.000000<br />yend: 0.9136121","x:  83.747070<br />y: 0.9136121<br />xend:  82.000000<br />yend: 0.9136121",null,"x:  82.000000<br />y: 0.9136121<br />xend:  82.000000<br />yend: 0.0000000","x:  82.000000<br />y: 0.9136121<br />xend:  82.000000<br />yend: 0.0000000",null,"x:  83.747070<br />y: 0.9136121<br />xend:  85.494141<br />yend: 0.9136121","x:  83.747070<br />y: 0.9136121<br />xend:  85.494141<br />yend: 0.9136121",null,"x:  85.494141<br />y: 0.9136121<br />xend:  85.494141<br />yend: 0.8616721","x:  85.494141<br />y: 0.9136121<br />xend:  85.494141<br />yend: 0.8616721",null,"x:  85.494141<br />y: 0.8616721<br />xend:  83.000000<br />yend: 0.8616721","x:  85.494141<br />y: 0.8616721<br />xend:  83.000000<br />yend: 0.8616721",null,"x:  83.000000<br />y: 0.8616721<br />xend:  83.000000<br />yend: 0.0000000","x:  83.000000<br />y: 0.8616721<br />xend:  83.000000<br />yend: 0.0000000",null,"x:  85.494141<br />y: 0.8616721<br />xend:  87.988281<br />yend: 0.8616721","x:  85.494141<br />y: 0.8616721<br />xend:  87.988281<br />yend: 0.8616721",null,"x:  87.988281<br />y: 0.8616721<br />xend:  87.988281<br />yend: 0.8007997","x:  87.988281<br />y: 0.8616721<br />xend:  87.988281<br />yend: 0.8007997",null,"x:  87.988281<br />y: 0.8007997<br />xend:  84.500000<br />yend: 0.8007997","x:  87.988281<br />y: 0.8007997<br />xend:  84.500000<br />yend: 0.8007997",null,"x:  84.500000<br />y: 0.8007997<br />xend:  84.500000<br />yend: 0.7176622","x:  84.500000<br />y: 0.8007997<br />xend:  84.500000<br />yend: 0.7176622",null,"x:  87.988281<br />y: 0.8007997<br />xend:  91.476562<br />yend: 0.8007997","x:  87.988281<br />y: 0.8007997<br />xend:  91.476562<br />yend: 0.8007997",null,"x:  91.476562<br />y: 0.8007997<br />xend:  91.476562<br />yend: 0.7588726","x:  91.476562<br />y: 0.8007997<br />xend:  91.476562<br />yend: 0.7588726",null,"x:  84.500000<br />y: 0.7176622<br />xend:  84.000000<br />yend: 0.7176622","x:  84.500000<br />y: 0.7176622<br />xend:  84.000000<br />yend: 0.7176622",null,"x:  84.000000<br />y: 0.7176622<br />xend:  84.000000<br />yend: 0.0000000","x:  84.000000<br />y: 0.7176622<br />xend:  84.000000<br />yend: 0.0000000",null,"x:  84.500000<br />y: 0.7176622<br />xend:  85.000000<br />yend: 0.7176622","x:  84.500000<br />y: 0.7176622<br />xend:  85.000000<br />yend: 0.7176622",null,"x:  85.000000<br />y: 0.7176622<br />xend:  85.000000<br />yend: 0.0000000","x:  85.000000<br />y: 0.7176622<br />xend:  85.000000<br />yend: 0.0000000",null,"x:  91.476562<br />y: 0.7588726<br />xend:  87.453125<br />yend: 0.7588726","x:  91.476562<br />y: 0.7588726<br />xend:  87.453125<br />yend: 0.7588726",null,"x:  87.453125<br />y: 0.7588726<br />xend:  87.453125<br />yend: 0.6489367","x:  87.453125<br />y: 0.7588726<br />xend:  87.453125<br />yend: 0.6489367",null,"x:  91.476562<br />y: 0.7588726<br />xend:  95.500000<br />yend: 0.7588726","x:  91.476562<br />y: 0.7588726<br />xend:  95.500000<br />yend: 0.7588726",null,"x:  95.500000<br />y: 0.7588726<br />xend:  95.500000<br />yend: 0.6540838","x:  95.500000<br />y: 0.7588726<br />xend:  95.500000<br />yend: 0.6540838",null,"x:  87.453125<br />y: 0.6489367<br />xend:  86.000000<br />yend: 0.6489367","x:  87.453125<br />y: 0.6489367<br />xend:  86.000000<br />yend: 0.6489367",null,"x:  86.000000<br />y: 0.6489367<br />xend:  86.000000<br />yend: 0.0000000","x:  86.000000<br />y: 0.6489367<br />xend:  86.000000<br />yend: 0.0000000",null,"x:  87.453125<br />y: 0.6489367<br />xend:  88.906250<br />yend: 0.6489367","x:  87.453125<br />y: 0.6489367<br />xend:  88.906250<br />yend: 0.6489367",null,"x:  88.906250<br />y: 0.6489367<br />xend:  88.906250<br />yend: 0.5622692","x:  88.906250<br />y: 0.6489367<br />xend:  88.906250<br />yend: 0.5622692",null,"x:  88.906250<br />y: 0.5622692<br />xend:  87.000000<br />yend: 0.5622692","x:  88.906250<br />y: 0.5622692<br />xend:  87.000000<br />yend: 0.5622692",null,"x:  87.000000<br />y: 0.5622692<br />xend:  87.000000<br />yend: 0.0000000","x:  87.000000<br />y: 0.5622692<br />xend:  87.000000<br />yend: 0.0000000",null,"x:  88.906250<br />y: 0.5622692<br />xend:  90.812500<br />yend: 0.5622692","x:  88.906250<br />y: 0.5622692<br />xend:  90.812500<br />yend: 0.5622692",null,"x:  90.812500<br />y: 0.5622692<br />xend:  90.812500<br />yend: 0.5217615","x:  90.812500<br />y: 0.5622692<br />xend:  90.812500<br />yend: 0.5217615",null,"x:  90.812500<br />y: 0.5217615<br />xend:  88.875000<br />yend: 0.5217615","x:  90.812500<br />y: 0.5217615<br />xend:  88.875000<br />yend: 0.5217615",null,"x:  88.875000<br />y: 0.5217615<br />xend:  88.875000<br />yend: 0.3935482","x:  88.875000<br />y: 0.5217615<br />xend:  88.875000<br />yend: 0.3935482",null,"x:  90.812500<br />y: 0.5217615<br />xend:  92.750000<br />yend: 0.5217615","x:  90.812500<br />y: 0.5217615<br />xend:  92.750000<br />yend: 0.5217615",null,"x:  92.750000<br />y: 0.5217615<br />xend:  92.750000<br />yend: 0.4454322","x:  92.750000<br />y: 0.5217615<br />xend:  92.750000<br />yend: 0.4454322",null,"x:  88.875000<br />y: 0.3935482<br />xend:  88.000000<br />yend: 0.3935482","x:  88.875000<br />y: 0.3935482<br />xend:  88.000000<br />yend: 0.3935482",null,"x:  88.000000<br />y: 0.3935482<br />xend:  88.000000<br />yend: 0.0000000","x:  88.000000<br />y: 0.3935482<br />xend:  88.000000<br />yend: 0.0000000",null,"x:  88.875000<br />y: 0.3935482<br />xend:  89.750000<br />yend: 0.3935482","x:  88.875000<br />y: 0.3935482<br />xend:  89.750000<br />yend: 0.3935482",null,"x:  89.750000<br />y: 0.3935482<br />xend:  89.750000<br />yend: 0.3900324","x:  89.750000<br />y: 0.3935482<br />xend:  89.750000<br />yend: 0.3900324",null,"x:  89.750000<br />y: 0.3900324<br />xend:  89.000000<br />yend: 0.3900324","x:  89.750000<br />y: 0.3900324<br />xend:  89.000000<br />yend: 0.3900324",null,"x:  89.000000<br />y: 0.3900324<br />xend:  89.000000<br />yend: 0.0000000","x:  89.000000<br />y: 0.3900324<br />xend:  89.000000<br />yend: 0.0000000",null,"x:  89.750000<br />y: 0.3900324<br />xend:  90.500000<br />yend: 0.3900324","x:  89.750000<br />y: 0.3900324<br />xend:  90.500000<br />yend: 0.3900324",null,"x:  90.500000<br />y: 0.3900324<br />xend:  90.500000<br />yend: 0.3141062","x:  90.500000<br />y: 0.3900324<br />xend:  90.500000<br />yend: 0.3141062",null,"x:  90.500000<br />y: 0.3141062<br />xend:  90.000000<br />yend: 0.3141062","x:  90.500000<br />y: 0.3141062<br />xend:  90.000000<br />yend: 0.3141062",null,"x:  90.000000<br />y: 0.3141062<br />xend:  90.000000<br />yend: 0.0000000","x:  90.000000<br />y: 0.3141062<br />xend:  90.000000<br />yend: 0.0000000",null,"x:  90.500000<br />y: 0.3141062<br />xend:  91.000000<br />yend: 0.3141062","x:  90.500000<br />y: 0.3141062<br />xend:  91.000000<br />yend: 0.3141062",null,"x:  91.000000<br />y: 0.3141062<br />xend:  91.000000<br />yend: 0.0000000","x:  91.000000<br />y: 0.3141062<br />xend:  91.000000<br />yend: 0.0000000",null,"x:  92.750000<br />y: 0.4454322<br />xend:  92.000000<br />yend: 0.4454322","x:  92.750000<br />y: 0.4454322<br />xend:  92.000000<br />yend: 0.4454322",null,"x:  92.000000<br />y: 0.4454322<br />xend:  92.000000<br />yend: 0.0000000","x:  92.000000<br />y: 0.4454322<br />xend:  92.000000<br />yend: 0.0000000",null,"x:  92.750000<br />y: 0.4454322<br />xend:  93.500000<br />yend: 0.4454322","x:  92.750000<br />y: 0.4454322<br />xend:  93.500000<br />yend: 0.4454322",null,"x:  93.500000<br />y: 0.4454322<br />xend:  93.500000<br />yend: 0.3069986","x:  93.500000<br />y: 0.4454322<br />xend:  93.500000<br />yend: 0.3069986",null,"x:  93.500000<br />y: 0.3069986<br />xend:  93.000000<br />yend: 0.3069986","x:  93.500000<br />y: 0.3069986<br />xend:  93.000000<br />yend: 0.3069986",null,"x:  93.000000<br />y: 0.3069986<br />xend:  93.000000<br />yend: 0.0000000","x:  93.000000<br />y: 0.3069986<br />xend:  93.000000<br />yend: 0.0000000",null,"x:  93.500000<br />y: 0.3069986<br />xend:  94.000000<br />yend: 0.3069986","x:  93.500000<br />y: 0.3069986<br />xend:  94.000000<br />yend: 0.3069986",null,"x:  94.000000<br />y: 0.3069986<br />xend:  94.000000<br />yend: 0.0000000","x:  94.000000<br />y: 0.3069986<br />xend:  94.000000<br />yend: 0.0000000",null,"x:  95.500000<br />y: 0.6540838<br />xend:  95.000000<br />yend: 0.6540838","x:  95.500000<br />y: 0.6540838<br />xend:  95.000000<br />yend: 0.6540838",null,"x:  95.000000<br />y: 0.6540838<br />xend:  95.000000<br />yend: 0.0000000","x:  95.000000<br />y: 0.6540838<br />xend:  95.000000<br />yend: 0.0000000",null,"x:  95.500000<br />y: 0.6540838<br />xend:  96.000000<br />yend: 0.6540838","x:  95.500000<br />y: 0.6540838<br />xend:  96.000000<br />yend: 0.6540838",null,"x:  96.000000<br />y: 0.6540838<br />xend:  96.000000<br />yend: 0.0000000","x:  96.000000<br />y: 0.6540838<br />xend:  96.000000<br />yend: 0.0000000",null,"x:  97.875000<br />y: 2.2926274<br />xend:  97.000000<br />yend: 2.2926274","x:  97.875000<br />y: 2.2926274<br />xend:  97.000000<br />yend: 2.2926274",null,"x:  97.000000<br />y: 2.2926274<br />xend:  97.000000<br />yend: 0.0000000","x:  97.000000<br />y: 2.2926274<br />xend:  97.000000<br />yend: 0.0000000",null,"x:  97.875000<br />y: 2.2926274<br />xend:  98.750000<br />yend: 2.2926274","x:  97.875000<br />y: 2.2926274<br />xend:  98.750000<br />yend: 2.2926274",null,"x:  98.750000<br />y: 2.2926274<br />xend:  98.750000<br />yend: 1.4877886","x:  98.750000<br />y: 2.2926274<br />xend:  98.750000<br />yend: 1.4877886",null,"x:  98.750000<br />y: 1.4877886<br />xend:  98.000000<br />yend: 1.4877886","x:  98.750000<br />y: 1.4877886<br />xend:  98.000000<br />yend: 1.4877886",null,"x:  98.000000<br />y: 1.4877886<br />xend:  98.000000<br />yend: 0.0000000","x:  98.000000<br />y: 1.4877886<br />xend:  98.000000<br />yend: 0.0000000",null,"x:  98.750000<br />y: 1.4877886<br />xend:  99.500000<br />yend: 1.4877886","x:  98.750000<br />y: 1.4877886<br />xend:  99.500000<br />yend: 1.4877886",null,"x:  99.500000<br />y: 1.4877886<br />xend:  99.500000<br />yend: 0.0000000","x:  99.500000<br />y: 1.4877886<br />xend:  99.500000<br />yend: 0.0000000",null,"x:  99.500000<br />y: 0.0000000<br />xend:  99.000000<br />yend: 0.0000000","x:  99.500000<br />y: 0.0000000<br />xend:  99.000000<br />yend: 0.0000000",null,"x:  99.000000<br />y: 0.0000000<br />xend:  99.000000<br />yend: 0.0000000","x:  99.000000<br />y: 0.0000000<br />xend:  99.000000<br />yend: 0.0000000",null,"x:  99.500000<br />y: 0.0000000<br />xend: 100.000000<br />yend: 0.0000000","x:  99.500000<br />y: 0.0000000<br />xend: 100.000000<br />yend: 0.0000000",null,"x: 100.000000<br />y: 0.0000000<br />xend: 100.000000<br />yend: 0.0000000","x: 100.000000<br />y: 0.0000000<br />xend: 100.000000<br />yend: 0.0000000"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":53.858032378580326,"r":13.283520132835205,"b":37.858032378580333,"l":27.895392278953928},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(235,235,235,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"<b> Dendrogram Visualization <\/b>","font":{"color":"rgba(0,0,0,1)","family":"","size":21.917808219178081},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-3.9500000000000002,104.95],"tickmode":"array","ticktext":["0","25","50","75","100"],"tickvals":[-4.4408920985006262e-16,25,50,75,100],"categoryorder":"array","categoryarray":["0","25","50","75","100"],"nticks":null,"ticks":"outside","tickcolor":"rgba(0,0,0,1)","ticklen":-7.3059360730593621,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.5313408053134081,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"x","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.12821427383984993,2.6924997506368484],"tickmode":"array","ticktext":["0","1","2"],"tickvals":[0,1,1.9999999999999998],"categoryorder":"array","categoryarray":["0","1","2"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":-7.3059360730593621,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(201,201,201,1)","gridwidth":1.1623080116230804,"zeroline":false,"anchor":"x","title":{"text":"y","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(235,235,235,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":18.264840182648406}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"5c50528139ed":{"x":{},"y":{},"xend":{},"yend":{},"type":"scatter"}},"cur_data":"5c50528139ed","visdat":{"5c50528139ed":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="part-4-introduction-to-topic-modeling" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Part 4: Introduction to Topic Modeling</h1>
<section id="get-ap-data-and-build-a-dtm-to-submit-for-the-lda-model" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="get-ap-data-and-build-a-dtm-to-submit-for-the-lda-model"><span class="header-section-number">6.1</span> Get AP Data and Build a DTM to submit for the LDA model</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(topicmodels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'topicmodels' was built under R version 4.3.3</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(AssociatedPress)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>ap_lda <span class="ot">&lt;-</span> topicmodels<span class="sc">::</span><span class="fu">LDA</span>(AssociatedPress, <span class="at">k=</span><span class="dv">8</span>, <span class="at">control =</span> <span class="fu">list</span>(<span class="at">seed=</span><span class="dv">1234</span>))</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>ap_lda</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>A LDA_VEM topic model with 8 topics.</code></pre>
</div>
</div>
</section>
<section id="explore-and-interpret-the-model" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="explore-and-interpret-the-model"><span class="header-section-number">6.2</span> Explore and Interpret the Model</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Extract beta matrix from the LDA model</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>beta_matrix <span class="ot">&lt;-</span> <span class="fu">exp</span>(ap_lda<span class="sc">@</span>beta)  <span class="co"># Convert log probabilities to probabilities</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Retrieve the terms (vocabulary) from the DocumentTermMatrix</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>terms <span class="ot">&lt;-</span> <span class="fu">colnames</span>(AssociatedPress)</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3: Validate the beta matrix dimensions with vocabulary size</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">ncol</span>(beta_matrix) <span class="sc">!=</span> <span class="fu">length</span>(terms)) {</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">"Mismatch between number of columns in beta_matrix and the length of terms."</span>)</span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4: Convert beta matrix to data frame and assign topic identifiers</span></span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>beta_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(beta_matrix)</span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>beta_df<span class="sc">$</span>topic <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(beta_df)</span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5: Pivot the data to a long format correctly</span></span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a>ap_topics_long <span class="ot">&lt;-</span> beta_df <span class="sc">%&gt;%</span></span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(</span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="sc">-</span>topic,      <span class="co"># Keep the topic column static</span></span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"term_index"</span>,  <span class="co"># Create index for terms</span></span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"beta"</span></span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb105-23"><a href="#cb105-23" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb105-24"><a href="#cb105-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">term_index =</span> <span class="fu">as.integer</span>(<span class="fu">gsub</span>(<span class="st">"V"</span>, <span class="st">""</span>, term_index)),  <span class="co"># Extract integer index</span></span>
<span id="cb105-25"><a href="#cb105-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">term =</span> terms[term_index]  <span class="co"># Map term names using the index</span></span>
<span id="cb105-26"><a href="#cb105-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb105-27"><a href="#cb105-27" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(topic, term, beta)</span>
<span id="cb105-28"><a href="#cb105-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-29"><a href="#cb105-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 6: Display the tidy data frame</span></span>
<span id="cb105-30"><a href="#cb105-30" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(ap_topics_long, <span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 3
   topic term            beta
   &lt;int&gt; &lt;chr&gt;          &lt;dbl&gt;
 1     1 aaron      3.85e-  5
 2     1 abandon    1.24e-  5
 3     1 abandoned  1.89e-  4
 4     1 abandoning 1.26e-141
 5     1 abbott     5.04e- 12
 6     1 abboud     1.13e- 20
 7     1 abc        2.02e- 23
 8     1 abcs       4.40e-  8
 9     1 abctvs     3.65e- 14
10     1 abdomen    1.33e- 26
11     1 abducted   2.19e-140
12     1 abduction  1.67e- 50
13     1 abductors  1.92e-146
14     1 abdul      1.60e- 10
15     1 abide      1.64e- 14
16     1 abilities  1.32e-  4
17     1 ability    1.47e-  4
18     1 ablaze     2.45e- 27
19     1 able       3.31e-  4
20     1 abm        5.23e-156</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 7: Extract the top terms for each topic using dplyr</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>ap_top_terms <span class="ot">&lt;-</span> ap_topics_long <span class="sc">%&gt;%</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(topic) <span class="sc">%&gt;%</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">top_n</span>(<span class="dv">10</span>, beta) <span class="sc">%&gt;%</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(topic, dplyr<span class="sc">::</span><span class="fu">desc</span>(beta))</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the top terms for each topic</span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(ap_top_terms, <span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 3
   topic term         beta
   &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;
 1     1 percent   0.0293 
 2     1 year      0.0139 
 3     1 million   0.00975
 4     1 billion   0.00911
 5     1 new       0.00664
 6     1 last      0.00605
 7     1 report    0.00525
 8     1 years     0.00512
 9     1 workers   0.00502
10     1 sales     0.00478
11     2 united    0.00965
12     2 bush      0.00960
13     2 states    0.00917
14     2 president 0.00855
15     2 soviet    0.00760
16     2 house     0.00578
17     2 trade     0.00528
18     2 bill      0.00522
19     2 congress  0.00489
20     2 i         0.00430</code></pre>
</div>
</div>
</section>
<section id="visualize-the-top-terms" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="visualize-the-top-terms"><span class="header-section-number">6.3</span> Visualize the Top Terms</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>ap_top_terms <span class="sc">%&gt;%</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">term =</span> <span class="fu">reorder</span>(term, beta)) <span class="sc">%&gt;%</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(term, beta, <span class="at">fill =</span> <span class="fu">factor</span>(topic))) <span class="sc">+</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">facet_wrap</span>(<span class="sc">~</span> topic, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>    ggthemes<span class="sc">::</span><span class="fu">theme_economist_white</span>() <span class="sc">+</span></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top Terms by Beta and Topic"</span>,</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">x =</span> <span class="st">"Term"</span>,)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab_9_O-Malley_Conie_files/figure-html/top%20terms%20visualization-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>beta_spread <span class="ot">&lt;-</span> ap_topics_long <span class="sc">%&gt;%</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">topic =</span> <span class="fu">paste0</span>(<span class="st">"topic"</span>, topic)) <span class="sc">%&gt;%</span>  <span class="co"># Create a topic identifier</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> topic,        <span class="co"># Pivot topic names to separate columns</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> beta         <span class="co"># Populate those columns with beta values</span></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(topic1) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(topic2) <span class="sc">&amp;</span> (topic1 <span class="sc">&gt;</span> <span class="fl">0.001</span> <span class="sc">|</span> topic2 <span class="sc">&gt;</span> <span class="fl">0.001</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">log_ratio =</span> <span class="fu">log2</span>(topic2 <span class="sc">/</span> topic1))</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>beta_spread</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 303 × 10
   term       topic1  topic2   topic3   topic4   topic5   topic6  topic7  topic8
   &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
 1 action    3.90e-4 1.10e-3 1.15e- 4 2.40e- 4 2.98e- 4 1.30e- 5 1.31e-3 3.88e-4
 2 added     5.71e-4 1.20e-3 6.77e- 4 4.55e- 4 3.86e- 4 4.98e- 4 2.70e-4 5.36e-4
 3 administ… 1.09e-3 4.11e-3 4.41e- 5 6.00e- 4 2.60e- 4 5.44e- 5 1.05e-3 4.17e-4
 4 agency    1.26e-3 4.48e-4 4.81e- 5 2.44e- 3 1.40e- 3 3.00e- 4 1.09e-3 3.39e-8
 5 ago       1.98e-3 4.51e-4 3.48e- 4 8.14e- 4 9.14e- 4 1.01e- 3 2.42e-4 1.45e-3
 6 agreed    9.72e-5 1.16e-3 7.62e- 4 5.14e- 5 6.08e- 4 1.52e- 4 1.55e-3 9.13e-5
 7 agreement 1.37e-6 3.94e-3 1.33e- 3 5.35e- 7 4.62e- 4 1.87e- 5 1.39e-3 6.27e-5
 8 agricult… 1.40e-3 2.97e-4 2.10e- 4 1.78e-12 5.67e- 5 1.48e-15 2.76e-5 2.17e-5
 9 aid       6.99e-5 3.94e-3 2.11e-17 2.95e- 4 2.45e- 4 3.17e- 4 6.72e-6 4.97e-8
10 air       1.45e-3 3.95e-4 1.88e- 8 5.89e- 3 2.59e-10 3.96e- 4 7.06e-4 2.34e-4
# ℹ 293 more rows
# ℹ 1 more variable: log_ratio &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>gamma_matrix <span class="ot">&lt;-</span> <span class="fu">exp</span>(ap_lda<span class="sc">@</span>gamma)  <span class="co"># Convert log probabilities to probabilities</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>document_count <span class="ot">&lt;-</span> <span class="fu">nrow</span>(AssociatedPress)</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>documents <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>document_count  <span class="co"># This is a placeholder, replace with actual document IDs if available</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>gamma_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(gamma_matrix)</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>gamma_df<span class="sc">$</span>document <span class="ot">&lt;-</span> documents</span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>ap_documents_long <span class="ot">&lt;-</span> gamma_df <span class="sc">%&gt;%</span></span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(</span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="sc">-</span>document,      <span class="co"># Keep the document column static</span></span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"topic_index"</span>,  <span class="co"># Create index for topics</span></span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"gamma"</span></span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">topic_index =</span> <span class="fu">as.integer</span>(<span class="fu">gsub</span>(<span class="st">"V"</span>, <span class="st">""</span>, topic_index)),  <span class="co"># Extract integer index</span></span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">topic =</span> topic_index  <span class="co"># Direct mapping for simplicity</span></span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb112-20"><a href="#cb112-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(document, topic, gamma)</span>
<span id="cb112-21"><a href="#cb112-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-22"><a href="#cb112-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(ap_documents_long, <span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 3
   document topic gamma
      &lt;int&gt; &lt;int&gt; &lt;dbl&gt;
 1        1     1  1.00
 2        1     2  1.00
 3        1     3  1.00
 4        1     4  1.00
 5        1     5  1.00
 6        1     6  2.71
 7        1     7  1.00
 8        1     8  1.00
 9        2     1  1.00
10        2     2  1.42
11        2     3  1.05
12        2     4  1.11
13        2     5  1.00
14        2     6  1.00
15        2     7  1.64
16        2     8  1.00
17        3     1  1.00
18        3     2  1.00
19        3     3  1.00
20        3     4  1.00</code></pre>
</div>
</div>
</section>
</section>
<section id="part-5-topic-modelling-sanity-check-with-project-gutenberg" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Part 5: Topic Modelling Sanity Check with Project Gutenberg</h1>
<section id="collect-and-prepare-the-data" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="collect-and-prepare-the-data"><span class="header-section-number">7.1</span> Collect and Prepare the Data</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">gutenberg_mirror =</span> <span class="st">"https://gutenberg.pglaf.org"</span>)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>books <span class="ot">&lt;-</span> gutenbergr<span class="sc">::</span><span class="fu">gutenberg_download</span>(<span class="fu">c</span>(<span class="dv">1259</span>, <span class="co"># Great Expectations (Dickens)</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>                                            <span class="dv">36</span>, <span class="co"># The War of the Worlds (Wells)</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>                                            <span class="dv">98</span>, <span class="co"># A Tale of Two Cities (Dickens)</span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>                                            <span class="dv">74</span>)) <span class="co"># The Adventures of Tom Sawyer (Twain)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: ! Could not download a book at https://gutenberg.pglaf.org/1/2/5/1259/1259.zip.
ℹ The book may have been archived.
ℹ Alternatively, You may need to select a different mirror.
→ See https://www.gutenberg.org/MIRRORS.ALL for options.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create labels for the books</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>books <span class="ot">&lt;-</span> books <span class="sc">%&gt;%</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">title =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>                                    gutenberg_id <span class="sc">==</span> <span class="dv">1259</span> <span class="sc">~</span> <span class="st">"Great Expectations"</span>,</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>                                    gutenberg_id <span class="sc">==</span> <span class="dv">36</span> <span class="sc">~</span> <span class="st">"The War of the Worlds"</span>,</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>                                    gutenberg_id <span class="sc">==</span> <span class="dv">98</span> <span class="sc">~</span> <span class="st">"Tale of Two Cities"</span>,</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>                                    gutenberg_id <span class="sc">==</span> <span class="dv">74</span> <span class="sc">~</span> <span class="st">"Tom Sawyer"</span>,</span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>                                    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>books</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 31,156 × 3
   gutenberg_id text                    title                
          &lt;int&gt; &lt;chr&gt;                   &lt;chr&gt;                
 1           36 "cover "                The War of the Worlds
 2           36 ""                      The War of the Worlds
 3           36 ""                      The War of the Worlds
 4           36 ""                      The War of the Worlds
 5           36 ""                      The War of the Worlds
 6           36 "The War of the Worlds" The War of the Worlds
 7           36 ""                      The War of the Worlds
 8           36 "by H. G. Wells"        The War of the Worlds
 9           36 ""                      The War of the Worlds
10           36 ""                      The War of the Worlds
# ℹ 31,146 more rows</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>by_chapter <span class="ot">&lt;-</span> books <span class="sc">%&gt;%</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(title) <span class="sc">%&gt;%</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Enhanced chapter detection for different formats</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">chapter =</span> <span class="fu">cumsum</span>(</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>                        stringr<span class="sc">::</span><span class="fu">str_detect</span>(text, stringr<span class="sc">::</span><span class="fu">regex</span>(<span class="st">"^chapter [</span><span class="sc">\\</span><span class="st">dIVXLC]"</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>)) <span class="sc">|</span></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>                        stringr<span class="sc">::</span><span class="fu">str_detect</span>(text, stringr<span class="sc">::</span><span class="fu">regex</span>(<span class="st">"^[</span><span class="sc">\\</span><span class="st">dIVXLC]+</span><span class="sc">\\</span><span class="st">."</span>, <span class="at">ignore_case =</span> <span class="cn">TRUE</span>))</span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(chapter <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove Project Gutenberg headers/footers</span></span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>stringr<span class="sc">::</span><span class="fu">str_detect</span>(text, <span class="st">"Project Gutenberg"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>stringr<span class="sc">::</span><span class="fu">str_detect</span>(text, <span class="st">"</span><span class="sc">\\</span><span class="st">*</span><span class="sc">\\</span><span class="st">*</span><span class="sc">\\</span><span class="st">* START OF"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>stringr<span class="sc">::</span><span class="fu">str_detect</span>(text, <span class="st">"</span><span class="sc">\\</span><span class="st">*</span><span class="sc">\\</span><span class="st">*</span><span class="sc">\\</span><span class="st">* END OF"</span>))</span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-17"><a href="#cb118-17" aria-hidden="true" tabindex="-1"></a>chapter_counts <span class="ot">&lt;-</span> by_chapter <span class="sc">%&gt;%</span></span>
<span id="cb118-18"><a href="#cb118-18" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(title) <span class="sc">%&gt;%</span></span>
<span id="cb118-19"><a href="#cb118-19" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">chapters =</span> dplyr<span class="sc">::</span><span class="fu">n_distinct</span>(chapter))</span>
<span id="cb118-20"><a href="#cb118-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-21"><a href="#cb118-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Chapters per book:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Chapters per book:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chapter_counts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  title                 chapters
  &lt;chr&gt;                    &lt;int&gt;
1 Tale of Two Cities          45
2 The War of the Worlds       27
3 Tom Sawyer                  70</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tokenize and remove stop words</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>by_chapter_word <span class="ot">&lt;-</span> by_chapter <span class="sc">%&gt;%</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">unite</span>(document, title, chapter) <span class="sc">%&gt;%</span></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>    tidytext<span class="sc">::</span><span class="fu">unnest_tokens</span>(word, text)</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Assuming 'word' is the column in 'by_chapter_word' representing the individual words</span></span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>stop_words_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">word =</span> stop_words)</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>word_counts <span class="ot">&lt;-</span> by_chapter_word <span class="sc">%&gt;%</span></span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">anti_join</span>(stop_words_df, <span class="at">by =</span> <span class="st">"word"</span>) <span class="sc">%&gt;%</span>  <span class="co"># Use 'by = "word"' to specify the join column</span></span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">count</span>(document, word, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="prepare-the-data-convert-the-tibble-to-a-dtm" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="prepare-the-data-convert-the-tibble-to-a-dtm"><span class="header-section-number">7.2</span> Prepare the Data: Convert the Tibble to a DTM</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create document-term matrix</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>chapters_dtm <span class="ot">&lt;-</span> word_counts <span class="sc">%&gt;%</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>    tidytext<span class="sc">::</span><span class="fu">cast_dtm</span>(document, word, n)</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>chapters_dtm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;&lt;DocumentTermMatrix (documents: 142, terms: 15384)&gt;&gt;
Non-/sparse entries: 77677/2106851
Sparsity           : 96%
Maximal term length: 18
Weighting          : term frequency (tf)</code></pre>
</div>
</div>
</section>
<section id="create-the-lda-topic-model" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="create-the-lda-topic-model"><span class="header-section-number">7.3</span> Create the LDA Topic Model</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit LDA model</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>chapters_lda <span class="ot">&lt;-</span> topicmodels<span class="sc">::</span><span class="fu">LDA</span>(chapters_dtm, <span class="at">k =</span> <span class="dv">4</span>, <span class="at">control =</span> <span class="fu">list</span>(<span class="at">seed =</span> <span class="dv">1234</span>))</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>chapters_lda</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>A LDA_VEM topic model with 4 topics.</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>chapters_beta_matrix <span class="ot">&lt;-</span> <span class="fu">exp</span>(chapters_lda<span class="sc">@</span>beta)  <span class="co"># Convert log probabilities to probabilities</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>chapters_terms <span class="ot">&lt;-</span> <span class="fu">colnames</span>(chapters_dtm)</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>chapters_beta_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(chapters_beta_matrix)</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>chapters_beta_df<span class="sc">$</span>topic <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(chapters_beta_df)</span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>chapters_topics_long <span class="ot">&lt;-</span> chapters_beta_df <span class="sc">%&gt;%</span></span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(</span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="sc">-</span>topic,      <span class="co"># Keep the topic column static</span></span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"term_index"</span>,  <span class="co"># Create index for terms</span></span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"beta"</span></span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb127-15"><a href="#cb127-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">term_index =</span> <span class="fu">as.integer</span>(<span class="fu">gsub</span>(<span class="st">"V"</span>, <span class="st">""</span>, term_index)),  <span class="co"># Extract integer index</span></span>
<span id="cb127-16"><a href="#cb127-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">term =</span> chapters_terms[term_index]  <span class="co"># Map term names using the index</span></span>
<span id="cb127-17"><a href="#cb127-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb127-18"><a href="#cb127-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(topic, term, beta)</span>
<span id="cb127-19"><a href="#cb127-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-20"><a href="#cb127-20" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(chapters_topics_long, <span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 3
   topic term             beta
   &lt;int&gt; &lt;chr&gt;           &lt;dbl&gt;
 1     1 mr          1.03e- 31
 2     1 tom         3.42e- 61
 3     1 miss        1.99e-  4
 4     1 madame      2.73e- 50
 5     1 brother     3.11e-  3
 6     1 prisoner    4.32e-107
 7     1 said        4.85e-  3
 8     1 huck        3.72e- 44
 9     1 stryver     1.18e-256
10     1 pross       4.11e- 36
11     1 defarge     1.63e- 50
12     1 becky       3.72e- 44
13     1 monseigneur 2.51e- 27
14     1 cruncher    4.63e- 84
15     1 wine        2.28e-  4
16     1 jerry       1.02e- 95
17     1 lorry       1.18e- 34
18     1 sir         2.41e-  4
19     1 barsad      9.71e- 74
20     1 darnay      3.24e-110</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>chapters_top_terms <span class="ot">&lt;-</span> chapters_topics_long <span class="sc">%&gt;%</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(topic) <span class="sc">%&gt;%</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">top_n</span>(<span class="dv">10</span>, beta) <span class="sc">%&gt;%</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(topic, dplyr<span class="sc">::</span><span class="fu">desc</span>(beta))</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the top terms for each topic</span></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(chapters_top_terms, <span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 3
   topic term        beta
   &lt;int&gt; &lt;chr&gt;      &lt;dbl&gt;
 1     1 one      0.00662
 2     1 upon     0.00588
 3     1 martians 0.00557
 4     1 people   0.00550
 5     1 came     0.00515
 6     1 said     0.00485
 7     1 towards  0.00450
 8     1 saw      0.00440
 9     1 black    0.00428
10     1 man      0.00405
11     2 said     0.0106 
12     2 mr       0.0102 
13     2 one      0.00683
14     2 lorry    0.00564
15     2 will     0.00478
16     2 defarge  0.00469
17     2 man      0.00455
18     2 upon     0.00443
19     2 little   0.00431
20     2 time     0.00427</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create visualization of top terms</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>top_terms_plot <span class="ot">&lt;-</span> chapters_top_terms <span class="sc">%&gt;%</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">term =</span> tidytext<span class="sc">::</span><span class="fu">reorder_within</span>(term, beta, topic)) <span class="sc">%&gt;%</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(beta, term, <span class="at">fill =</span> <span class="fu">factor</span>(topic))) <span class="sc">+</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_col</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">facet_wrap</span>(<span class="sc">~</span>topic, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>    tidytext<span class="sc">::</span><span class="fu">scale_y_reordered</span>() <span class="sc">+</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Top 10 Terms in Each Topic"</span>,</span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> <span class="st">"Beta Score"</span>,</span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>    ggthemes<span class="sc">::</span><span class="fu">theme_economist_white</span>()</span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>top_terms_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab_9_O-Malley_Conie_files/figure-html/gutenberg%20dtm%20visualization-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>gamma_matrix <span class="ot">&lt;-</span> <span class="fu">exp</span>(chapters_lda<span class="sc">@</span>gamma)  <span class="co"># Convert log probabilities to probabilities</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>document_ids <span class="ot">&lt;-</span> <span class="fu">rownames</span>(chapters_dtm)  <span class="co"># Placeholder, adjust to your source</span></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>gamma_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(gamma_matrix)</span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>gamma_df<span class="sc">$</span>document <span class="ot">&lt;-</span> document_ids</span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>chapters_gamma <span class="ot">&lt;-</span> gamma_df <span class="sc">%&gt;%</span></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(</span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">cols =</span> <span class="sc">-</span>document,          <span class="co"># All columns except 'document'</span></span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">names_to =</span> <span class="st">"topic_index"</span>,  <span class="co"># Create an index for topics</span></span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">values_to =</span> <span class="st">"gamma"</span>        <span class="co"># Store probabilities in 'gamma'</span></span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">topic_index =</span> <span class="fu">as.integer</span>(<span class="fu">gsub</span>(<span class="st">"V"</span>, <span class="st">""</span>, topic_index)),</span>
<span id="cb132-16"><a href="#cb132-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">topic =</span> topic_index</span>
<span id="cb132-17"><a href="#cb132-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb132-18"><a href="#cb132-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate document field back into title and chapter</span></span>
<span id="cb132-19"><a href="#cb132-19" aria-hidden="true" tabindex="-1"></a>chapters_gamma <span class="ot">&lt;-</span> chapters_gamma <span class="sc">%&gt;%</span></span>
<span id="cb132-20"><a href="#cb132-20" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">separate</span>(document, <span class="fu">c</span>(<span class="st">"title"</span>, <span class="st">"chapter"</span>), <span class="at">sep =</span> <span class="st">"_"</span>, <span class="at">convert =</span> <span class="cn">TRUE</span>)</span>
<span id="cb132-21"><a href="#cb132-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate average topic probabilities per book</span></span>
<span id="cb132-22"><a href="#cb132-22" aria-hidden="true" tabindex="-1"></a>book_topics <span class="ot">&lt;-</span> chapters_gamma <span class="sc">%&gt;%</span></span>
<span id="cb132-23"><a href="#cb132-23" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(title, topic) <span class="sc">%&gt;%</span></span>
<span id="cb132-24"><a href="#cb132-24" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">gamma =</span> <span class="fu">mean</span>(gamma)) <span class="sc">%&gt;%</span></span>
<span id="cb132-25"><a href="#cb132-25" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'title'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
</section>
<section id="create-a-per-document-classification" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="create-a-per-document-classification"><span class="header-section-number">7.4</span> Create a Per-Document Classification</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create book-topic heatmap</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>book_topics_plot <span class="ot">&lt;-</span> book_topics <span class="sc">%&gt;%</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="fu">factor</span>(topic), title, <span class="at">fill =</span> gamma)) <span class="sc">+</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Topic Distribution Across Books"</span>,</span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> <span class="st">"Topic"</span>,</span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> <span class="st">"Book"</span>,</span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">fill =</span> <span class="st">"Gamma"</span>) <span class="sc">+</span></span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a>    ggthemes<span class="sc">::</span><span class="fu">theme_economist_white</span>()</span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a>book_topics_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab_9_O-Malley_Conie_files/figure-html/gutenberg%20document%20classification-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print top terms for each topic</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Top terms for each topic:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Top terms for each topic:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>chapters_top_terms <span class="sc">%&gt;%</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(topic) <span class="sc">%&gt;%</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(topic, <span class="sc">-</span>beta) <span class="sc">%&gt;%</span></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="at">n =</span> <span class="dv">40</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 3
# Groups:   topic [4]
   topic term        beta
   &lt;int&gt; &lt;chr&gt;      &lt;dbl&gt;
 1     1 one      0.00662
 2     1 upon     0.00588
 3     1 martians 0.00557
 4     1 people   0.00550
 5     1 came     0.00515
 6     1 said     0.00485
 7     1 towards  0.00450
 8     1 saw      0.00440
 9     1 black    0.00428
10     1 man      0.00405
11     2 said     0.0106 
12     2 mr       0.0102 
13     2 one      0.00683
14     2 lorry    0.00564
15     2 will     0.00478
16     2 defarge  0.00469
17     2 man      0.00455
18     2 upon     0.00443
19     2 little   0.00431
20     2 time     0.00427
21     3 tom      0.0151 
22     3 said     0.00762
23     3 now      0.00688
24     3 upon     0.00555
25     3 boy      0.00443
26     3 away     0.00417
27     3 one      0.00416
28     3 little   0.00409
29     3 got      0.00402
30     3 back     0.00399
31     4 tom      0.0190 
32     4 said     0.0114 
33     4 huck     0.0102 
34     4 now      0.00752
35     4 don’t    0.00744
36     4 time     0.00596
37     4 it’s     0.00595
38     4 one      0.00594
39     4 well     0.00572
40     4 got      0.00544</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print topic distribution by book</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Topic distribution by book:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Topic distribution by book:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>book_topics <span class="sc">%&gt;%</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> topic,</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">values_from =</span> gamma,</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">names_prefix =</span> <span class="st">"Topic "</span>) <span class="sc">%&gt;%</span></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="st">`</span><span class="at">Topic 1</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  title                 `Topic 1` `Topic 2` `Topic 3` `Topic 4`
  &lt;chr&gt;                     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 The War of the Worlds      2.65      1.00      1.00      1.03
2 Tom Sawyer                 1.01      1.01      1.77      1.87
3 Tale of Two Cities         1.01      2.53      1.10      1.02</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate and print the most distinctive words for each book</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>distinctive_words <span class="ot">&lt;-</span> by_chapter_word <span class="sc">%&gt;%</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">separate</span>(document, <span class="fu">c</span>(<span class="st">"title"</span>, <span class="st">"chapter"</span>), <span class="at">sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">anti_join</span>(stop_words_df) <span class="sc">%&gt;%</span></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">count</span>(title, word) <span class="sc">%&gt;%</span></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>    tidytext<span class="sc">::</span><span class="fu">bind_tf_idf</span>(word, title, n) <span class="sc">%&gt;%</span></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(title) <span class="sc">%&gt;%</span></span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">slice_max</span>(tf_idf, <span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(word)`</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Most distinctive words for each book:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Most distinctive words for each book:"</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>distinctive_words <span class="sc">%&gt;%</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(title, <span class="fu">desc</span>(tf_idf)) <span class="sc">%&gt;%</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">40</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 31 × 6
   title                 word             n       tf   idf   tf_idf
   &lt;chr&gt;                 &lt;chr&gt;        &lt;int&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
 1 Tale of Two Cities    lorry          339 0.00524  1.10  0.00575 
 2 Tale of Two Cities    defarge        282 0.00436  1.10  0.00479 
 3 Tale of Two Cities    mr             622 0.00961  0.405 0.00390 
 4 Tale of Two Cities    madame         192 0.00297  1.10  0.00326 
 5 Tale of Two Cities    manette        156 0.00241  1.10  0.00265 
 6 Tale of Two Cities    pross          150 0.00232  1.10  0.00255 
 7 Tale of Two Cities    carton         149 0.00230  1.10  0.00253 
 8 Tale of Two Cities    darnay         141 0.00218  1.10  0.00239 
 9 Tale of Two Cities    lucie          124 0.00192  1.10  0.00210 
10 Tale of Two Cities    monsieur       117 0.00181  1.10  0.00199 
11 The War of the Worlds martians       162 0.00539  1.10  0.00593 
12 The War of the Worlds pit             83 0.00276  1.10  0.00304 
13 The War of the Worlds martian         79 0.00263  1.10  0.00289 
14 The War of the Worlds woking          53 0.00176  1.10  0.00194 
15 The War of the Worlds towards        129 0.00430  0.405 0.00174 
16 The War of the Worlds curate          35 0.00117  1.10  0.00128 
17 The War of the Worlds railway         29 0.000966 1.10  0.00106 
18 The War of the Worlds artilleryman    28 0.000932 1.10  0.00102 
19 The War of the Worlds ulla            28 0.000932 1.10  0.00102 
20 The War of the Worlds smashed         27 0.000899 1.10  0.000988
21 The War of the Worlds weybridge       27 0.000899 1.10  0.000988
22 Tom Sawyer            tom            721 0.0196   0.405 0.00793 
23 Tom Sawyer            huck           232 0.00630  1.10  0.00692 
24 Tom Sawyer            becky          102 0.00277  1.10  0.00304 
25 Tom Sawyer            tom’s           97 0.00263  1.10  0.00289 
26 Tom Sawyer            aunt            80 0.00217  1.10  0.00239 
27 Tom Sawyer            sid             77 0.00209  1.10  0.00230 
28 Tom Sawyer            injun           75 0.00204  1.10  0.00224 
29 Tom Sawyer            joe            138 0.00375  0.405 0.00152 
30 Tom Sawyer            cave            47 0.00128  1.10  0.00140 
31 Tom Sawyer            polly           47 0.00128  1.10  0.00140 </code></pre>
</div>
</div>
<p>Python Code would not run - it is included in a separate ipynb file.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>